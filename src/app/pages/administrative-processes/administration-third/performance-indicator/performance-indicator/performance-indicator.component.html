<app-card [header]="true">
  <div class="ch-content" header>
    <h5 class="title">Indicador de desempeño</h5>
    <div class="col-md-5 buttons">
      <!-- <app-columns-select [(settings)]="settings"></app-columns-select> -->
    </div>
  </div>
  <div body>
    <div class="row margin-input">
      <div class="col-md-6">
        <form [formGroup]="performanceIndicatorForm" class="form-material">
          <div class="row margin-input">
            <div class="col-md-4">
              <form-field
                [control]="performanceIndicatorForm.get('dateCapture')"
                label="Fecha de captura">
                <input
                  type="text"
                  [maxDate]="maxDate"
                  [minDate]="minDate"
                  formControlName="dateCapture"
                  placeholder="Fecha de captura"
                  class="form-control"
                  bsDatepicker />
              </form-field>
            </div>
            <div class="col-md-4">
              <h6 class="title">{{ status == 0 ? 'CERRADO' : 'ABIERTO' }}</h6>
            </div>
          </div>
          <div class="row margin-input">
            <div class="col-md-4">
              <form-field
                [control]="performanceIndicatorForm.get('year')"
                label="Año">
                <input
                  type="number"
                  formControlName="year"
                  placeholder="Año"
                  (input)="validateYear()"
                  class="form-control" />
              </form-field>
            </div>
            <div class="col-md-4">
              <form-field
                [control]="performanceIndicatorForm.get('month')"
                label="Mes">
                <input
                  type="number"
                  formControlName="month"
                  placeholder="Mes"
                  (input)="validateMonth()"
                  class="form-control" />
              </form-field>
            </div>
            <div class="col-md-3">
              <h6 class="title">{{ month }}</h6>
            </div>
          </div>
          <div class="row margin-input">
            <div class="col-md-8">
              <ng-custom-select-loading
                [form]="performanceIndicatorForm"
                formControlName="regionalCoordination"
                [multiple]="false"
                label="Coordinación Regional"
                value="id"
                bindLabel="description"
                paramSearch="search"
                path="catalog/api/v1/delegation/get-all">
              </ng-custom-select-loading>
            </div>
            <div class="col-md-3">
              <form-field
                [control]="performanceIndicatorForm.get('user')"
                label="Usuario">
                <input
                  type="text"
                  formControlName="user"
                  placeholder="Usuario"
                  (input)="enabledSearch()"
                  class="form-control" />
              </form-field>
            </div>

            <div class="d-flex justify-content-center">
              <div class="m-3">
                <button
                  type="button"
                  class="btn btn-primary active btn-sm"
                  [disabled]="!flagSearch"
                  (click)="search()">
                  Buscar <i class="bx bx-search-alt bx-sm float-icon"></i>
                </button>
              </div>
              <div class="m-3">
                <button
                  type="button"
                  class="btn btn-danger active btn-sm"
                  (click)="cleanData()">
                  Limpiar <i class="fas fa-eraser bx-sm float-icon"></i>
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="col-md-6">
        <form [formGroup]="performanceIndicatorFormE_I" class="form-material">
          <h5 class="title">Estrategia y Reportes que se debieron entregar</h5>
          <div class="row margin-input">
            <div class="col-md-8">
              <h6 class="title">Estrategia de administración:</h6>
            </div>
            <div class="col-md-2">
              <form-field
                [control]="performanceIndicatorFormE_I.get('strategyAdmin')">
                <input
                  type="number"
                  style="text-align: center"
                  placeholder="0"
                  class="form-control"
                  [readonly]="!enabled"
                  formControlName="strategyAdmin"
                  id="strategyAdmin"
                  (input)="validateEAE($event)" />
              </form-field>
            </div>
          </div>
          <div class="row margin-input">
            <div class="col-md-8">
              <h6 class="title">Reportes de Implementacón:</h6>
            </div>
            <div class="col-md-2">
              <form-field
                [control]="performanceIndicatorFormE_I.get('reportImp')">
                <input
                  style="text-align: center"
                  type="number"
                  placeholder="0"
                  class="form-control"
                  formControlName="reportImp"
                  id="ReportImp"
                  [readonly]="!enabled"
                  (input)="validateRI($event)" />
              </form-field>
            </div>
          </div>
          <h5 class="title">Estrategia y Reportes entregados en tiempo</h5>
          <div class="row margin-input">
            <div class="col-md-8">
              <h6 class="title">Estrategia de administración:</h6>
            </div>
            <div class="col-md-2">
              <form-field
                [control]="performanceIndicatorFormE_I.get('strategyAdmin2')">
                <input
                  style="text-align: center"
                  type="number"
                  placeholder="0"
                  class="form-control"
                  formControlName="strategyAdmin2"
                  id="stategyAdmin2"
                  [readonly]="!enabled"
                  (input)="validateEAE2($event)" />
              </form-field>
            </div>
          </div>
          <div class="row margin-input">
            <div class="col-md-8">
              <h6 class="title">Reportes de Implementacón:</h6>
            </div>
            <div class="col-md-2">
              <form-field
                [control]="performanceIndicatorFormE_I.get('reportImp2')">
                <input
                  style="text-align: center"
                  type="number"
                  placeholder="0"
                  class="form-control"
                  formControlName="reportImp2"
                  id="ReportImp2"
                  [readonly]="!enabled"
                  (input)="validateRI2($event)" />
              </form-field>
            </div>
          </div>
        </form>
      </div>

      <div class="row pt-3">
        <div class="col-md-12 text-right">
          <span
            >Porcentaje de Cumplimiento&#58; <b>{{ compliance }}&#37;</b></span
          >
        </div>
      </div>

      <div class="row pt-3">
        <div class="col-md-12 text-right">
          <button
            type="button"
            class="btn btn-primary active btn-sm"
            (click)="reportAndTables()">
            Reporte
          </button>
        </div>
      </div>
    </div>

    <app-card [header]="true" *ngIf="showResolucion == true">
      <div class="ch-content" header>
        <h5 class="title">
          Folios Estrategias de Aministraci&Oacute;n y Reportes de
          Implementaci&Oacute;n
        </h5>
      </div>

      <div body>
        <div class="row pt-4">
          <div class="col-md-6">
            <h5 class="title">Folio Estrategia de Administración</h5>
            <div [class]="loading ? 'table-loading' : ''">
              <ng2-smart-table
                [attr.class]="'table-bordered'"
                [settings]="settings"
                [source]="data">
              </ng2-smart-table>
            </div>
            <app-pagination
              [params]="paramsA"
              [totalItems]="totalItemsA"></app-pagination>
            <!--<div class="row justify-content-space-evenly">
              <div class="col-md-3">
                <button
                  class="btn btn-primary btn-sm active"
                  (click)="openStrategy('')">
                  Incorpora
                </button>
              </div>
              <div class="col-md-3">
                <button class="btn btn-danger btn-sm active">
                  Eliminar
                  <i class="fa fa-trash" aria-hidden="true"></i>
                </button>
              </div>
            </div>-->
          </div>
          <div class="col-md-6">
            <h5 class="title">Folio Reportes de Implementación</h5>
            <div [class]="loading ? 'table-loading' : ''">
              <ng2-smart-table
                [attr.class]="'table-bordered'"
                [settings]="settings2"
                [source]="dataF">
              </ng2-smart-table>
            </div>
            <app-pagination
              [params]="paramsI"
              [totalItems]="totalItemsI"></app-pagination>
            <div class="row justify-content-space-evenly">
              <div class="col-md-3">
                <button
                  class="btn btn-primary btn-sm active"
                  (click)="downloadReport()">
                  {{ loadingText }}
                </button>
              </div>
              <div class="col-md-3">
                <button
                  class="btn btn-danger btn-sm active"
                  (click)="closeStrategy()">
                  Cerrar
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </app-card>
  </div>
</app-card>
