<app-card [header]="true" [footer]="true">
  <div class="ch-content" header>
    <h5 class="title">Relación de decomiso</h5>
  </div>
  <div body>
    <div class="row mt-3 mb-3">
      <form class="form-material" [formGroup]="form">
        <div class="row mt-4">
          <div class="col-md-2">
            <form-field
              [control]="form.get('forfeitureKey')"
              label="Cve. Decomiso">
              <input
                type="text"
                class="form-control"
                formControlName="forfeitureKey" />
            </form-field>
          </div>
          <div class="col-md-4">
            <button
              type="button"
              class="btn btn-primary active btn-sm m-1"
              (click)="openFile()">
              Buscar <i class="bx bx-search-alt bx-sm float-icon"></i>
            </button>
            <button
              type="button"
              tooltip="Genera reporte de relación de decomiso."
              class="btn btn-primary active btn-sm m-2"
              (click)="callReport()">
              Imprimir<i class="bx bx-printer bx-sm float-icon"></i>
            </button>
            <button
              class="btn btn-danger btn-sm active m-1"
              (click)="cleanFilter()">
              Limpiar <i class="fas fa-eraser"> </i>
            </button>
          </div>

          <div>
            <div class="row">
              <div class="col-6 mt-4">
                <form-field [control]="form.get('import')" label="Importe">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="import"
                    min="0"
                    oninput="if(this.value.length > 12) this.value = this.value.slice(0, 12);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6 mt-4">
                <form-field [control]="form.get('pgr')" label="PGR">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="pgr"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6 mt-4">
                <form-field [control]="form.get('ssa')" label="SSA">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="ssa"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6 mt-4">
                <form-field [control]="form.get('pjf')" label="PJF">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="pjf"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6 mt-4">
                <form-field
                  [control]="form.get('totalAmount')"
                  label="Importe Total">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="totalAmount"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
            </div>
          </div>
        </div>
      </form>
      <br />
      <hr />
      <form class="form-material" [formGroup]="Only">
        <div class="row mt-4">
          <div class="col-2 mt-4">
            <form-field [control]="Only.get('nobien')" label="No. Bien">
              <ng-select
                addTagText="Agregar Elemento"
                class="form-control scroll-line"
                formControlName="nobien"
                [items]="[]"
                [addTag]="true"
                [multiple]="true">
              </ng-select>
            </form-field>
          </div>
          <div class="col-md-1 mt-4">
            <form-radio label="M.N.">
              <input type="radio" formControlName="radio" value="1424" />
            </form-radio>
          </div>
          <div class="col-md-1 mt-4">
            <form-radio label="U.S. DLLS.">
              <input type="radio" formControlName="radio" value="1426" />
            </form-radio>
          </div>
          <div class="col-md-1 mt-4">
            <form-radio label="Conv Nume">
              <input type="radio" formControlName="radio" value="1427" />
            </form-radio>
          </div>
          <div class="col-md-4 mt-4">
            <button
              type="button"
              class="btn btn-primary active btn-sm m-1"
              (click)="validateMoney()">
              Buscar <i class="bx bx-search-alt bx-sm float-icon"></i>
            </button>
            <button
              class="btn btn-primary btn-sm active m-1"
              (click)="aproveOnly()">
              Aprobar <i class="fa fa-check" aria-hidden="true"></i>
            </button>
            <button
              class="btn btn-danger btn-sm active m-1"
              (click)="cleanOnly()">
              Limpiar <i class="fas fa-eraser"> </i>
            </button>
          </div>
        </div>
      </form>

      <form class="form-material" [formGroup]="file">
        <div class="row container">
          <div class="col-md-5 mt-4">
            <button
              type="button"
              class="btn btn-sm btn-success active"
              (click)="filee.click()">
              Importar Excel <i class="bi bi-file-earmark-excel-fill"></i>
            </button>
            <input
              type="file"
              name="filee"
              #filee
              class="d-none"
              accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
              (change)="onFileChange($event)" />
            <button
              class="btn btn-primary btn-sm active m-1"
              (click)="aprove()">
              Aprobar <i class="fa fa-check" aria-hidden="true"></i>
            </button>
            <button class="btn btn-danger btn-sm active m-1" (click)="clean()">
              Limpiar <i class="fas fa-eraser"> </i>
            </button>
            <button
              tooltip="Formato de Ejemplo"
              containerClass="tooltip-style"
              type="button"
              class="btn btn-info btn-sm active m-1 pointer"
              (click)="exportCsv()">
              <i class="bi bi-question-circle"></i>
            </button>
          </div>

          <div class="col-xs-2 mt-4">
            <form-field
              [control]="file.get('recordRead')"
              label="Registros Leídos:">
              <input
                type="number"
                class="form-control"
                formControlName="recordRead"
                readonly />
            </form-field>
          </div>
          <div class="col-xs-2 mt-4">
            <form-field
              [control]="file.get('recordsProcessed')"
              label="Registros Procesados:">
              <input
                type="number"
                class="form-control"
                formControlName="recordsProcessed"
                readonly />
            </form-field>
          </div>
          <div class="col-xs-2 mt-4">
            <form-field [control]="file.get('processed')" label="Procesados:">
              <input
                type="number"
                class="form-control"
                formControlName="processed"
                readonly />
            </form-field>
          </div>
          <div class="col-xs-1 mt-4">
            <form-field [control]="file.get('wrong')" label="Erróneos:">
              <input
                type="number"
                class="form-control"
                formControlName="wrong"
                readonly />
            </form-field>
          </div>
        </div>
      </form>
      <div class="row mt-4" *ngIf="unt">
        <div class="col-md-12">
          <ng-scrollbar
            [track]="'all'"
            [ngStyle]="{ height: loading ? '0px' : '300px' }">
            <div [class]="loading ? 'table-loading' : ''">
              <ng2-smart-table
                [attr.class]="'table-bordered table-responsive'"
                [settings]="settings"
                [source]="source"></ng2-smart-table>
            </div>
          </ng-scrollbar>
        </div>
        <!--<app-pagination
          [params]="params"
          [totalItems]="totalItems"></app-pagination>-->
      </div>
      <div class="row mt-4" *ngIf="until">
        <div class="col-md-12">
          <ng-scrollbar
            [track]="'all'"
            [ngStyle]="{ height: loading ? '0px' : '300px' }">
            <div [class]="loading2 ? 'table-loading' : ''">
              <ng2-smart-table
                [attr.class]="'table-bordered table-responsive'"
                [settings]="settings2"
                [source]="dato"></ng2-smart-table>
            </div>
          </ng-scrollbar>
        </div>
        <!--<app-pagination
                [params]="params"
                [totalItems]="totalItems"></app-pagination>-->
      </div>
    </div>
  </div>
</app-card>
