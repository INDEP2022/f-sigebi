<app-card [header]="true" [footer]="true">
  <div class="ch-content" header>
    <h5 class="title">Relación de decomiso</h5>
  </div>
  <div body>
    <div class="row mt-3 mb-3">
      <form class="form-material" [formGroup]="form">
        <div class="row mt-4">
          <div class="col-md-2">
            <form-field
              [control]="form.get('forfeitureKey')"
              label="Clave Decomiso">
              <input
                type="text"
                class="form-control"
                formControlName="forfeitureKey" />
            </form-field>
          </div>
          <div class="col-2">
            <button
              type="button"
              class="btn btn-primary active btn-sm"
              (click)="openFile()">
              <i class="bx bx-search-alt bx-sm float-icon"></i>
            </button>
            <button
              type="button"
              tooltip="Genera reporte de relación de decomiso."
              class="btn btn-primary active btn-sm m-3"
              (click)="callReport()">
              Imprimir<i class="bx bx-printer bx-sm float-icon"></i>
            </button>
            <button
              class="btn btn-danger btn-sm active mr-3"
              (click)="cleanFilter()">
              Limpiar <i class="fas fa-eraser"> </i></button
            >`
          </div>

          <div class="col-md-7">
            <div class="row">
              <div class="col-6">
                <form-field [control]="form.get('import')" label="Importe">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="import"
                    min="0"
                    oninput="if(this.value.length > 12) this.value = this.value.slice(0, 12);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6">
                <form-field [control]="form.get('pgr')" label="PGR">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="pgr"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6 mt-4">
                <form-field [control]="form.get('ssa')" label="SSA">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="ssa"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6 mt-4">
                <form-field [control]="form.get('pjf')" label="PJF">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="pjf"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
              <div class="col-6 mt-4">
                <form-field
                  [control]="form.get('totalAmount')"
                  label="Importe Total">
                  <input
                    type="number"
                    class="form-control"
                    formControlName="totalAmount"
                    oninput="if(this.value.length > 17) this.value = this.value.slice(0, 17);"
                    readonly />
                </form-field>
              </div>
            </div>
          </div>
        </div>
      </form>
      <br />
      <hr />
      <form class="form-material" [formGroup]="file">
        <div class="row mt-4">
          <!--<div class="col-md-2">
            <button class="btn btn-secondary btn-sm active">
              Abrir archivo de texto
            </button>
          </div>
          <div class="col-md-2">
            <input
              type="file"
              #FileInput
              class="form-control"
              formControlName="recordRead" />
          </div>-->
          <div class="col-md-4">
            <div class="col-md-12">
              <button
                type="button"
                class="btn btn-sm btn-success active"
                (click)="filee.click()">
                Importar Excel <i class="bi bi-file-earmark-excel-fill"></i>
              </button>
              <input
                type="file"
                name="filee"
                #filee
                class="d-none"
                accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                (change)="onFileChange($event)" />
              <button
                class="btn btn-primary btn-sm active m-2"
                (click)="aprove()">
                Aprobar <i class="fa fa-check" aria-hidden="true"></i>
              </button>
              <button
                class="btn btn-danger btn-sm active m-1"
                (click)="clean()">
                Limpiar <i class="fas fa-eraser"> </i></button
              >`
            </div>
          </div>
          <div class="col-md-2">
            <form-field
              [control]="file.get('recordRead')"
              label="Registros Leídos:">
              <input
                type="number"
                class="form-control"
                formControlName="recordRead"
                oninput="if(this.value.length > 10) this.value = this.value.slice(0, 10);"
                readonly />
            </form-field>
          </div>
          <div class="col-md-2">
            <form-field
              [control]="file.get('recordsProcessed')"
              label="Registros Procesados:">
              <input
                type="number"
                class="form-control"
                formControlName="recordsProcessed"
                oninput="if(this.value.length > 10) this.value = this.value.slice(0, 10);"
                readonly />
            </form-field>
          </div>
          <div class="col-md-2">
            <form-field [control]="file.get('processed')" label="Procesados:">
              <input
                type="number"
                class="form-control"
                formControlName="processed"
                oninput="if(this.value.length > 10) this.value = this.value.slice(0, 10);"
                readonly />
            </form-field>
          </div>
          <div class="col-md-1">
            <form-field [control]="file.get('wrong')" label="Erroneos:">
              <input
                type="number"
                class="form-control"
                formControlName="wrong"
                oninput="if(this.value.length > 10) this.value = this.value.slice(0, 10);"
                readonly />
            </form-field>
          </div>
        </div>
      </form>
      <div class="row">
        <div class="col-md-12">
          <ng-scrollbar
            [track]="'all'"
            [ngStyle]="{ height: loading ? '0px' : '300px' }">
            <div [class]="loading ? 'table-loading' : ''">
              <ng2-smart-table
                [attr.class]="'table-bordered table-responsive'"
                [settings]="settings"
                [source]="source"></ng2-smart-table>
            </div>
          </ng-scrollbar>
        </div>
      </div>
    </div>
  </div>
</app-card>
