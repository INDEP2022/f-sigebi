<app-card [header]="true">
  <div class="ch-content" header>
    <div class="d-flex">
      <div class="mr-auto p-2">
        <h5 class="title">Ejecutar programaci&oacute;n de entrega</h5>
      </div>
      <div
        class="p-2"
        *ngIf="programmingDetailPanel.status == 'EJECUTAR_ENTREGA'">
        <button
          (click)="finalizeDelivery()"
          type="button"
          class="btn btn-sm btn-primary active">
          Finalizar Entrega
        </button>
      </div>
      <div
        class="p-2"
        *ngIf="
          statusProgramming == 'BIENES_NO_ENTREGADOS' ||
          statusProgramming == 'FORMATO_RECLAMACION_SAE' ||
          statusProgramming == 'FORMATO_RECLAMACION_TE' ||
          statusProgramming == 'RESTITUCION_BIENES'
        ">
        <button
          (click)="finalizeClassify()"
          type="button"
          class="btn btn-sm btn-primary active">
          Finalizar Clasificación
        </button>
      </div>
      <div class="p-2" *ngIf="statusProgramming == 'VERIFICACION_BIENES'">
        <button
          (click)="finalizeVerify()"
          type="button"
          class="btn btn-sm btn-primary active">
          Finalizar Verificación
        </button>
      </div>
      <div
        class="p-2"
        *ngIf="
          statusProgramming == 'APROBAR_NO_ENT_ESP' ||
          statusProgramming == 'APROBAR_NO_ENT_NUM'
        ">
        <button
          (click)="sendApprove()"
          type="button"
          class="btn btn-sm btn-primary active">
          Enviar Aprobación
        </button>
      </div>
    </div>
  </div>
  <div body style="margin-top: -30px">
    <h5 class="title">
      <p>
        <a
          class="text-color"
          (click)="showSearchForm = true"
          *ngIf="!showSearchForm">
          <i class="fa fa-angle-right" aria-hidden="true"></i> Detalles
          programaci&oacute;n</a
        >
      </p>

      <p>
        <a
          class="text-color"
          (click)="showSearchForm = false"
          *ngIf="showSearchForm">
          <i class="fa fa-angle-down" aria-hidden="true"></i> Detalles
          programaci&oacute;n</a
        >
      </p>
    </h5>

    <div *ngIf="showSearchForm">
      <div class="row">
        <div class="col-md-5">
          <form class="form-horizontal" style="margin: 0 auto">
            <div class="form-group">
              <label class="col-lg-5 text-right">Tipo evento:</label>
              <span *ngIf="programmingDetailPanel.typeEvent == 1">
                Ventas
              </span>
              <span *ngIf="programmingDetailPanel.typeEvent == 2">
                Donación
              </span>
              <span *ngIf="programmingDetailPanel.typeEvent == 3">
                Destrucción
              </span>
              <span *ngIf="programmingDetailPanel.typeEvent == 4">
                Devolución
              </span>
            </div>

            <div class="form-group">
              <label class="col-lg-5 text-right">Folio:</label>
              <span> {{ programmingDetailPanel.folio }} </span>
            </div>

            <div class="form-group">
              <label class="col-lg-5 text-right">Transferente:</label>
              <span> {{ programmingDetailPanel.transferId }} </span>
            </div>

            <div class="form-group">
              <label class="col-lg-5 text-right">Fecha page entrega:</label>
              <span>
                {{ programmingDetailPanel.startDate | date : 'MM/dd/yy' }}
              </span>
            </div>
          </form>
        </div>

        <div class="col-md-6">
          <form class="form-horizontal" style="margin: 0 auto">
            <div class="form-group">
              <label class="col-lg-4 text-right">Fecha final entrega:</label>
              <span>
                {{ programmingDetailPanel.endDate | date : 'MM/dd/yy' }}
              </span>
            </div>

            <div class="form-group">
              <label class="col-lg-4 text-right">Almac&eacute;n:</label>
              <span> {{ programmingDetailPanel.store }} </span>
            </div>

            <div
              class="form-group"
              *ngIf="programmingDetailPanel.typeEvent == 1">
              <label class="col-lg-4 text-right">Cliente:</label>
              <span> {{ programmingDetailPanel.client }} </span>
            </div>
          </form>
        </div>
        <div
          class="col-md-6"
          *ngIf="
            programmingDetailPanel?.typeUser == 'TLP' &&
            programmingDetailPanel.status == 'FORMATO_RECLAMACION_SAE'
          ">
          <div class="form-group">
            <label class="col-lg-4 text-right">Correo Dirección:</label>
            <span> {{ programmingDetailPanel.emailAddressCenterTe }} </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Detalle Programación por Destrucción -->
    <div *ngIf="programmingDetailPanel.typeEvent == 5">
      <hr />
      <div class="row">
        <h5 class="title">
          <p>
            <a
              class="text-color"
              (click)="showDetailProgDestruc = true"
              *ngIf="!showDetailProgDestruc">
              <i class="fa fa-angle-right" aria-hidden="true"></i>
              Detalles Programaci&oacute;n por Destrucci&oacute;n</a
            >
          </p>

          <p>
            <a
              class="text-color"
              (click)="showDetailProgDestruc = false"
              *ngIf="showDetailProgDestruc">
              <i class="fa fa-angle-down" aria-hidden="true"></i>
              Detalles Programaci&oacute;n por Destrucci&oacute;n</a
            >
          </p>
        </h5>
      </div>
      <div class="row" *ngIf="showDetailProgDestruc">
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right">No. Of&iacute;cio:</label>
            <span> {{ programmingDetailPanel.officeDestructionNumber }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right"
              >M&eacute;todo Destrucci&oacute;n:</label
            >
            <span> {{ programmingDetailPanel.metodDestruction }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right"
              >Ubicaci&oacute;n Destrucci&oacute;n:</label
            >
            <span> {{ programmingDetailPanel.metodDestruction }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right">Nombre Destinatario:</label>
            <span> {{ programmingDetailPanel.addressee }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right"
              >Plazo &#40;d&iacute;as&#41;:</label
            >
            <span> {{ programmingDetailPanel.term }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right">Nombre Contribuyente:</label>
            <span> {{ programmingDetailPanel.taxpayerName }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right">Cargo Destinatario:</label>
            <span> {{ programmingDetailPanel.chargeAddressee }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right">Empresa:</label>
            <span> {{ programmingDetailPanel.company }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right"
              >Nombre Representante Legal:</label
            >
            <span> {{ programmingDetailPanel.legalRepresentativeName }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right"
              >Direcci&oacute;n Destinatario:</label
            >
            <span> {{ programmingDetailPanel.addressAddressee }} </span>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label class="col-lg-4 text-right">Lugar Destrucci&oacute;n:</label>
            <span> {{ programmingDetailPanel.placeDestruction }} </span>
          </div>
        </div>
      </div>
    </div>
    <!-- FIN -->
    <hr />
    <div class="row">
      <h5 class="title">Ejecuci&oacute;n entrega de bienes</h5>
    </div>
    <!-- BOTONES GLOBALES -->
    <div class="row pt-4">
      <div class="form-inline justify-content-end btn-toolbar">
        <a
          *ngIf="
            statusProgramming == 'RESTITUCION_BIENES' ||
            statusProgramming == 'APROBAR_NO_ENT_ESP' ||
            statusProgramming == 'APROBAR_NO_ENT_NUM'
          "
          style="cursor: pointer"
          (click)="photos()"
          class="link-primary"
          >Fotografias <i class="fa fa-picture-o" aria-hidden="true"></i></a
        >&nbsp;
        <!-- lsEstatusProgramacion -->
        <a
          *ngIf="statusProgramming == 'RESTITUCION_BIENES'"
          style="cursor: pointer"
          (click)="photos()"
          class="link-primary"
          >Expediente <i class="fa fa-file" aria-hidden="true"></i></a
        >&nbsp;
        <a
          *ngIf="programmingDetailPanel.status == 'EJECUTAR_ENTREGA'"
          style="cursor: pointer"
          (click)="certificateDelivery(1)"
          class="link-primary"
          >Constancia entregados
          <i class="fa fa-folder-open" aria-hidden="true"></i></a
        >&nbsp;
        <a
          *ngIf="
            programmingDetailPanel.typeEvent != 3 &&
            programmingDetailPanel.status == 'EJECUTAR_ENTREGA'
          "
          (click)="certificateDelivery(2)"
          style="cursor: pointer"
          class="link-primary"
          >Constancia no entregados
          <i class="fa fa-folder-open" aria-hidden="true"></i></a
        >&nbsp;
        <a
          *ngIf="
            programmingDetailPanel.typeEvent == 1 &&
            programmingDetailPanel.status == 'EJECUTAR_ENTREGA'
          "
          (click)="certificateDelivery(3)"
          style="cursor: pointer"
          class="link-primary"
          >Constancia no aceptados
          <i class="fa fa-folder-open" aria-hidden="true"></i></a
        >&nbsp;
        <a
          *ngIf="
            programmingDetailPanel.typeEvent == 1 &&
            programmingDetailPanel.status == 'EJECUTAR_ENTREGA'
          "
          (click)="certificateDelivery(4)"
          style="cursor: pointer"
          class="link-primary"
          >Constancia no retirados
          <i class="fa fa-folder-open" aria-hidden="true"></i></a
        >&nbsp;

        <button
          type="button"
          class="btn btn-sm btn-primary active"
          (click)="save()">
          Guardar <i aria-hidden="true" class="fa fa-save"></i>
        </button>
      </div>
    </div>
    <!-- FIN BOTONES GLOBALES -->

    <!-- EJECUCION PROGRAMACION ENTREGA BIENES TIPO REST -->
    <div
      *ngIf="
        statusProgramming == 'APROBAR_NO_ENT_ESP' ||
        statusProgramming == 'APROBAR_NO_ENT_NUM'
      ">
      <div class="row pt-5">
        <div class="col-md-12">
          <div class="table-responsive">
            <div [class]="loadingEEB ? 'table-loading' : ''">
              <ng2-smart-table
                [attr.class]="'table-bordered table-responsive'"
                [settings]="progDelivGoodTypeRestSettings"
                [source]="progDelivGoodTypeRestArray"
                (rowSelect)="selectGoodTypeRestRows($event)"
                ><!-- (rowSelect)="editRequest($event)" (edit)="openForm($event.data)" -->
              </ng2-smart-table>
            </div>
          </div>
          <app-pagination
            [params]="progDelivGoodTypeRestParams"
            [totalItems]="progDelivGoodTypeRestTotalItems"></app-pagination>
        </div>
      </div>
    </div>
    <!-- FIN -->

    <!-- PROG ENTREGA BIENES NO ENTREGADOS -->
    <div
      *ngIf="
        statusProgramming == 'BIENES_NO_ENTREGADOS' ||
        statusProgramming == 'FORMATO_RECLAMACION_SAE' ||
        statusProgramming == 'VERIFICACION_BIENES' ||
        statusProgramming == 'FORMATO_RECLAMACION_TE' ||
        statusProgramming == 'RESTITUCION_BIENES'
      ">
      <div class="row">
        <div class="btn-toolbar pt-5">
          <button class="btn btn-success btn-sm active" (click)="entryOrder()">
            Orden de Ingreso
          </button>
          <button
            class="btn btn-primary btn-sm active"
            (click)="sendApproval()">
            Enviar a Aprobación
          </button>
          <button
            class="btn btn-danger btn-sm active"
            (click)="claimmingForm()">
            Formato de Reclamación
          </button>
          <button
            class="btn btn-danger btn-sm active"
            *ngIf="statusProgramming == 'RESTITUCION_BIENES'"
            (click)="changeTypeRestitucion('NUMERARIO')">
            Numerario
          </button>
          <button
            class="btn btn-danger btn-sm active"
            (click)="changeTypeRestitucion('EN_ESPECIE')"
            *ngIf="statusProgramming == 'RESTITUCION_BIENES'">
            En Especie
          </button>
        </div>
      </div>
      <div class="row pt-5">
        <div class="col-md-12">
          <div class="table-responsive">
            <div [class]="loadingPENE ? 'table-loading' : ''">
              <ng2-smart-table
                [attr.class]="'table-bordered table-responsive'"
                #tablePEGNE
                id="tablePegene"
                [settings]="progDelivGoodNDSettings"
                [source]="progDelivGoodNDArray"
                (userRowSelect)="selectGoodNoDelivered($event)">
              </ng2-smart-table>
            </div>
          </div>
          <app-pagination
            [params]="progDelivGoodNDParams"
            [totalItems]="progDelivGoodNDTotalItems"></app-pagination>
        </div>
      </div>
    </div>
    <!-- FIN -->

    <!-- EJECUCION DE BIENES ENTREGA -->
    <div class="row pt-3">
      <div
        class="row"
        *ngIf="programmingDetailPanel.status == 'EJECUTAR_ENTREGA'">
        <div class="btn-toolbar pt-5">
          <button class="btn btn-success btn-sm active" (click)="exportCsv()">
            <i class="fa fa-arrow-down" aria-hidden="true"></i> Descargar
          </button>
          <button
            class="btn btn-primary btn-sm active"
            (click)="delivery('entragados')">
            <i class="fa fa-check-circle" aria-hidden="true"></i> Entregados
          </button>
          <button
            class="btn btn-danger btn-sm active"
            (click)="noDelivery('noEntregados')">
            <i class="fa fa-times-circle" aria-hidden="true"></i> No entregados
          </button>
        </div>

        <div class="row pt-5">
          <div class="col-md-12">
            <div class="table-responsive">
              <div [class]="loading ? 'table-loading' : ''">
                <ng2-smart-table
                  #table
                  id="table"
                  [attr.class]="'table-bordered table-responsive'"
                  [settings]="GoodDeliverySettings"
                  [source]="goodDeliveryArray"
                  (userRowSelect)="selectRows($event)"
                  ><!-- (rowSelect)="editRequest($event)" (edit)="openForm($event.data)" -->
                </ng2-smart-table>
              </div>
            </div>
            <app-pagination
              [params]="goodParams"
              [totalItems]="devgoodTotalItems"></app-pagination>
          </div>
        </div>
      </div>

      <div
        class="table-responsive pt-5"
        *ngIf="programmingDetailPanel.status == 'EJECUTAR_ENTREGA'">
        <div class="btn-toolbar">
          <button
            (click)="editConstancy()"
            class="btn btn-primary btn-sm active"
            *ngIf="this.programmingDetailPanel.typeEvent != 3">
            Editar <i class="fa fa-pencil" aria-hidden="true"></i>
          </button>
          <button (click)="newDocument()" class="btn btn-primary btn-sm active">
            Documentos de la constancia
            <i class="fa fa-folder" aria-hidden="true"></i>
          </button>
        </div>

        <div class="row pt-5">
          <div class="col-md-12">
            <div class="table-responsive">
              <div [class]="loadingT2 ? 'table-loading' : ''">
                <ng2-smart-table
                  #table2
                  id="table2"
                  [attr.class]="'table-bordered table-responsive'"
                  [settings]="constancyDeliverySettings"
                  [source]="constancyDeliveryArray"
                  (delete)="close($event.data)"
                  (edit)="preview($event.data)"
                  (rowSelect)="selectConstance($event)"
                  ><!-- (rowSelect)="editRequest($event)" (edit)="openForm($event.data)" -->
                </ng2-smart-table>
              </div>
            </div>
            <app-pagination
              [params]="constancyParams"
              [totalItems]="constancyTotalItems"></app-pagination>
          </div>
        </div>
      </div>
    </div>
  </div>
</app-card>
