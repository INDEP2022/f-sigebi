<app-card [header]="true" [footer]="true">
  <div class="ch-content" header>
    <div class="col-md-12">
      <h5 class="title">REPORTES DE CARTAS DE LIBERACIÓN DE INMUEBLES</h5>
    </div>
  </div>

  <div body>
    <form [formGroup]="comerLibsForm" class="form-material">
      <app-card [header]="true" [footer]="true">
        <div class="ch-content" header>
          <div class="col-md-12">
            <h5 class="title">EVENTO Y LOTE</h5>
          </div>
        </div>

        <div body>
          <div class="row">
            <div class="col-md-2 mt-3">
              <ngx-select
                [data]="selectDataEvent"
                bindLabel="id"
                label="Evento"
                value="id"
                (fetchItems)="getEventData($event)"
                (change)="changeEvent($event)"
                [form]="comerLibsForm"
                [showTooltip]="true"
                [searchOnInit]="true"
                termMaxLength="100"
                control="evento"></ngx-select>
            </div>
            <div class="col-md-4 mt-3">
              <div>
                <form-field
                  [control]="comerLibsForm.get('evento_descripcion')"
                  label="Descripción del Evento">
                  <textarea
                    name=""
                    id=""
                    cols="2"
                    rows="2"
                    type="text"
                    class="form-control"
                    formControlName="evento_descripcion"
                    readonly>
                  </textarea>
                </form-field>
              </div>
            </div>
            <div class="col-md-2 mt-3">
              <ngx-select
                [readonly]="!valLote"
                [data]="selectDataLote"
                bindLabel="idLot"
                label="Lote"
                value="idLot"
                (fetchItems)="getLoteData($event)"
                (change)="changeLote($event)"
                [form]="comerLibsForm"
                [showTooltip]="true"
                [searchOnInit]="true"
                termMaxLength="100"
                control="lote"></ngx-select>
            </div>
            <div class="col-md-4 mt-3">
              <div>
                <form-field
                  [control]="comerLibsForm.get('lote_descripcion')"
                  label="Descripción del Lote">
                  <textarea
                    name=""
                    id=""
                    cols="2"
                    rows="2"
                    type="text"
                    class="form-control"
                    formControlName="lote_descripcion"
                    readonly>
                  </textarea>
                  <!-- <input
                  type="text"
                  class="form-control"
                  formControlName="lote_descripcion"
                  readonly /> -->
                </form-field>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12 text-center">
              <button
                type="button"
                class="btn btn-primary active btn-sm mr-3"
                (click)="searchComer()">
                Buscar
                <i class="bx bx-search-alt bx-sm float-icon"></i>
              </button>
              <button
                (click)="cleanForm()"
                type="button"
                class="btn btn-danger active btn-sm mr-3">
                Limpiar
                <i class="fa fa-eraser" aria-hidden="true"></i>
              </button>
            </div>
          </div>
        </div>
      </app-card>
      <app-card [header]="true" [footer]="true">
        <div class="ch-content" header>
          <div class="col-md-12">
            <h5 class="title">CARTA DE LIBERACIÓN</h5>
          </div>
        </div>
        <div body>
          <div class="row">
            <div class="col-md-12">
              <div class="row p-3">
                <div class="col-md-12 text-end justify-content-end mb-2">
                  <!-- <div class="d-inline"> -->
                  <button
                    [disabled]="!valResult"
                    type="button"
                    tooltip="Ver más coincidencias"
                    class="btn btn-primary btn-sm active mr-3"
                    (click)="openModalSearch()">
                    <i class="bx bx-list-plus bx-sm float-icon"></i>
                  </button>
                  <confirm-button
                    [className]="'btn-primary mr-3'"
                    [disabled]="!comerLibsForm.valid || loadingSave"
                    [btnSmall]="true"
                    [loading]="loadingSave"
                    (confirm)="saveData()"></confirm-button>
                  <!-- </div> -->
                  <button
                    [disabled]="!comerLibsForm.value.lote"
                    type="button"
                    class="btn btn-info active btn-sm mr-3"
                    (click)="cleanLib(1)">
                    Nuevo
                    <i class="bx bx-plus bx-sm float-icon"></i>
                  </button>
                </div>
                <div class="col-12">
                  <div class="row">
                    <div class="col-md-6 mt-3">
                      <div>
                        <form-field
                          [control]="comerLibsForm.get('oficio')"
                          label="Oficio">
                          <input
                            [readonly]="!disabledFields || dataVal"
                            type="text"
                            maxlength="50"
                            class="form-control"
                            formControlName="oficio" />
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-6 mt-3">
                      <div>
                        <form-field
                          [control]="comerLibsForm.get('puesto')"
                          label="Puesto">
                          <input
                            [readonly]="!disabledFields"
                            type="text"
                            class="form-control"
                            formControlName="puesto"
                            maxlength="50" />
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-12 mt-3">
                      <div>
                        <form-field
                          [control]="comerLibsForm.get('diridoA')"
                          label="Dirigido a">
                          <input
                            [readonly]="!disabledFields"
                            #inputValue
                            type="text"
                            class="form-control"
                            formControlName="diridoA"
                            maxlength="50" />
                        </form-field>
                      </div>
                    </div>
                    <div class="card-body">
                      <form-field
                        class="col-md-12 col-sm-12 col-12 p-2"
                        [control]="comerLibsForm.get('parrafo1')"
                        label="P&aacute;rrafo 1">
                        <textarea
                          [readonly]="!disabledFields"
                          maxlength="500"
                          class="form-control text-justify"
                          formControlName="parrafo1"
                          cols="3"
                          rows="3">
                        </textarea>
                      </form-field>
                    </div>
                    <div class="col-md-12 mt-2">
                      <div>
                        <form-field
                          [control]="comerLibsForm.get('adjudicatorio')"
                          label="Adjudicatario">
                          <input
                            type="text"
                            class="form-control"
                            formControlName="adjudicatorio"
                            readonly />
                        </form-field>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row p-3">
                <div class="col-md-12 justify-content-center">
                  <h6>Bienes</h6>
                  <div class="row">
                    <form-loader *ngIf="bienesLoading"></form-loader>
                    <div class="col-md-12">
                      <ng-scrollbar
                        [track]="'all'"
                        [ngStyle]="{
                          height: bienesLoading ? '0px' : '300px'
                        }">
                        <ng2-smart-table
                          [attr.class]="''"
                          [settings]="settings"
                          [source]="dataTableGood">
                        </ng2-smart-table>
                      </ng-scrollbar>
                    </div>
                    <app-pagination
                      [params]="paramsBienes"
                      [totalItems]="totalItems"></app-pagination>
                  </div>
                </div>
              </div>
              <div class="row p-3">
                <div class="col-md-6 mt-3">
                  <div>
                    <form-field
                      [control]="comerLibsForm.get('factura')"
                      label="No. Factura">
                      <input
                        [readonly]="!disabledFields"
                        type="text"
                        maxlength="20"
                        class="form-control"
                        formControlName="factura" />
                    </form-field>
                  </div>
                </div>
                <div class="col-md-6 mt-3">
                  <div>
                    <form-field
                      [control]="comerLibsForm.get('fechaFactura')"
                      label="Fecha Factura">
                      <input
                        [readonly]="!disabledFields"
                        bsDatepicker
                        class="form-control"
                        formControlName="fechaFactura" />
                    </form-field>
                  </div>
                </div>
                <div class="card-body">
                  <form-field
                    class="col-md-12 col-sm-12 col-12 p-2"
                    [control]="comerLibsForm.get('parrafo2')"
                    label="P&aacute;rrafo 2">
                    <textarea
                      [readonly]="!disabledFields"
                      maxlength="500"
                      class="form-control text-justify"
                      formControlName="parrafo2"
                      cols="3"
                      rows="3"></textarea>
                  </form-field>
                </div>
                <div class="col-md-4 mt-3">
                  <form-field [control]="comerLibsForm.get('firmante')">
                    <ngx-select
                      [readonly]="!disabledFields"
                      [data]="selectDataUser0"
                      bindLabel="user"
                      label="Firmante"
                      value="user"
                      (fetchItems)="getUsers($event, 0)"
                      (change)="changeUser($event, 0)"
                      [form]="comerLibsForm"
                      [showTooltip]="true"
                      [searchOnInit]="true"
                      termMaxLength="50"
                      control="firmante">
                    </ngx-select>
                    <!-- <input
                    maxlength="500"
                    class="form-control"
                    formControlName="firmante"
                    [readonly]="!disabledFields"
                      /> -->
                  </form-field>
                </div>
                <div class="col-md-8 mt-3">
                  <form-field
                    [control]="comerLibsForm.get('puestoFirma')"
                    label="Puesto Firmante">
                    <input
                      maxlength="500"
                      class="form-control"
                      formControlName="puestoFirma"
                      readonly />
                  </form-field>
                </div>
                <div class="col-md-4 mt-3">
                  <form-field [control]="comerLibsForm.get('ccp1')">
                    <ngx-select
                      [readonly]="!disabledFields"
                      [data]="selectDataUser1"
                      bindLabel="user"
                      label="CCP1"
                      value="user"
                      (fetchItems)="getUsers($event, 1)"
                      (change)="changeUser($event, 1)"
                      [form]="comerLibsForm"
                      [showTooltip]="true"
                      [searchOnInit]="true"
                      termMaxLength="50"
                      control="ccp1">
                    </ngx-select>
                    <!-- <input
                    type="text"
                    [disabled]="!validPermisos"
                    maxlength="50"
                    class="form-control"
                    formControlName="ccp1"
                      /> -->
                  </form-field>
                </div>
                <div class="col-md-8 mt-3">
                  <form-field
                    [control]="comerLibsForm.get('puestoCcp1')"
                    label="Puesto CCP1">
                    <input
                      type="text"
                      [disabled]="!validPermisos"
                      maxlength="50"
                      class="form-control"
                      formControlName="puestoCcp1"
                      readonly />
                  </form-field>
                </div>
                <div class="col-md-4 mt-3">
                  <form-field [control]="comerLibsForm.get('ccp2')">
                    <ngx-select
                      [readonly]="!disabledFields"
                      [data]="selectDataUser2"
                      bindLabel="user"
                      label="CCP2"
                      value="user"
                      (fetchItems)="getUsers($event, 2)"
                      (change)="changeUser($event, 2)"
                      [form]="comerLibsForm"
                      [showTooltip]="true"
                      [searchOnInit]="true"
                      control="ccp2">
                    </ngx-select>
                    <!-- <input
                    [readonly]="!validPermisos"
                    type="text"
                    maxlength="50"
                    class="form-control"
                    formControlName="ccp2"
                      /> -->
                  </form-field>
                </div>
                <div class="col-md-8 mt-3">
                  <form-field
                    [control]="comerLibsForm.get('puestoCcp2')"
                    label="Puesto CCP2">
                    <input
                      type="text"
                      maxlength="50"
                      class="form-control"
                      formControlName="puestoCcp2"
                      readonly />
                  </form-field>
                </div>
              </div>
            </div>
          </div>
        </div>
      </app-card>
    </form>
    <div footer>
      <div class="d-flex flex-row justify-content-center align-items-center">
        <div class="m-3">
          <button
            type="button"
            class="btn btn-primary active btn-sm"
            (click)="Generar()">
            Imprimir
            <i class="bx bx-printer bx-sm float-icon"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</app-card>
