<app-card [header]="true">
  <div class="ch-content" header>
    <div class="d-flex justify-content-between">
      <h5 class="title">DICTAMINACIONES JUR&Iacute;DICAS</h5>
      <div class="d-inline mr-2">
        <button
          *ngIf="!isSearch"
          type="button"
          class="btn btn-primary active btn-sm"
          (click)="searchExp()">
          <i class="bx bx-search-alt bx-sm float-icon"></i>
        </button>
        <button
          *ngIf="isSearch"
          type="button"
          class="btn btn-primary active btn-sm ml-2"
          (click)="clearSearch()">
          <i class="bx bx-x bx-sm float-icon"></i>
        </button>
      </div>
    </div>
  </div>

  <div body>
    <form [formGroup]="legalForm" class="container-fluid form-material">
      <div class="row">
        <div class="col-sm-12 col-12 col-md-12 col-lg-12 p-2">
          <div class="row mt-5">
            <div class="col-md-4">
              <div class="row">
                <form-field [control]="legalForm.get('tipoDictaminacion')">
                  <ngx-select
                    [searchOnInit]="true"
                    [searchable]="false"
                    [data]="typesDict"
                    [form]="legalForm"
                    label="Tipo Dictaminaci贸n"
                    value="id"
                    bindLabel="typeDict"
                    control="tipoDictaminacion"
                    (change)="onTypeDictChange($event)"></ngx-select>
                </form-field>
              </div>
              <div class="row mt-3">
                <form-field
                  [control]="legalForm.get('noExpediente')"
                  label="No. Expediente">
                  <input
                    type="text"
                    [readOnly]="isSearch"
                    class="form-control"
                    formControlName="noExpediente" />
                </form-field>
              </div>
              <div class="row mt-3">
                <form-field
                  [control]="legalForm.get('preliminaryInquiry')"
                  label="Averiguaci&oacute;n Previa">
                  <input
                    [readOnly]="isSearch"
                    class="form-control"
                    formControlName="preliminaryInquiry" />
                </form-field>
              </div>
              <div class="row mt-3">
                <form-field
                  [control]="legalForm.get('criminalCase')"
                  label="Causa Penal">
                  <input
                    [readOnly]="isSearch"
                    class="form-control"
                    formControlName="criminalCase" />
                </form-field>
              </div>
            </div>

            <div class="col-md-2">
              <div class="row ps-4" [ngClass]="{ 'not-press': !activeRadio }">
                <form-radio label="Normal">
                  <input type="radio" formControlName="tipo" value="N" />
                </form-radio>
                <form-radio label="Paquete">
                  <input type="radio" formControlName="tipo" value="P" />
                </form-radio>
              </div>
            </div>

            <div class="col-md-6">
              <div class="row">
                <div class="col-md-6">
                  <form-field
                    [control]="legalForm.get('fechaPPFF')"
                    [label]="label">
                    <input
                      class="form-control"
                      formControlName="fechaPPFF"
                      bsDatepicker
                      [maxDate]="maxDate" />
                  </form-field>
                </div>

                <div class="col-md-6">
                  <form-field
                    [control]="legalForm.get('fecDicta')"
                    label="Fecha Dictaminaci贸n">
                    <input
                      [readOnly]="true"
                      formControlName="fecDicta"
                      class="form-control"
                      bsDatepicker />
                  </form-field>
                </div>
                <div class="col-md-6" *ngIf="!hideForm">
                  <form-field
                    [control]="legalForm.get('fecNotiAse')"
                    label="Fec. Notif Aseg">
                    <input
                      formControlName="fecNotiAse"
                      class="form-control"
                      bsDatepicker />
                  </form-field>
                </div>
                <div class="col-md-6" *ngIf="!hideForm">
                  <form-field
                    [control]="legalForm.get('fecRes')"
                    label="Fecha Resoluci贸n">
                    <input
                      formControlName="fecRes"
                      class="form-control"
                      bsDatepicker />
                  </form-field>
                </div>
                <div class="col-md-6 col-md-offset-6 mt-3" *ngIf="!hideForm">
                  <form-field
                    [control]="legalForm.get('fecNoti')"
                    label="Fecha Notificaci贸n">
                    <input
                      formControlName="fecNoti"
                      class="form-control"
                      bsDatepicker />
                  </form-field>
                </div>
                <div class="col-md-12">
                  <form-field [control]="legalForm.get('autoriza_remitente')">
                    <ngx-select
                      label="Autoriza Dict."
                      [form]="legalForm"
                      [data]="users$"
                      (fetchItems)="getUsers($event)"
                      bindLabel="userAndName"
                      control="autoriza_remitente"
                      [searchOnInit]="true"
                      [showTooltip]="true"
                      termMaxLength="30"
                      [labelTemplate]="userLabel"
                      [optionTemplate]="userOption">
                    </ngx-select>
                    <ng-template #userLabel let-item="item">
                      {{ item.id + ' - ' + item.name }}
                    </ng-template>
                    <ng-template #userOption let-item="item">
                      <div [title]="item.id + '-' + item.name">
                        {{ item.id + ' - ' + item.name }}
                      </div>
                    </ng-template>
                  </form-field>
                </div>

                <div class="col-md-12 mt-3">
                  <form-field
                    [control]="legalForm.get('cveOficio')"
                    label="Cve&#46; Oficio">
                    <input
                      [readOnly]="true"
                      class="form-control"
                      #cveOficio
                      formControlName="cveOficio" />
                  </form-field>
                </div>
                <div class="col-md-12 text-danger text-center">
                  <div>
                    <strong>Estatus {{ statusDict }}</strong>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="row">
                <form-check
                  class="col-md-12"
                  label="&#191;El expediente es delito propiedad intelectual&#63;"
                  for="esPropiedad">
                  <input
                    id="esPropiedad-check"
                    type="checkbox"
                    class="form-control"
                    formControlName="esPropiedad" />
                </form-check>
              </div>
              <div class="row mt-5">
                <form-field
                  [control]="legalForm.get('observations')"
                  label="Observaciones del Dictamen">
                  <textarea
                    rows="3"
                    class="form-control"
                    formControlName="observations"></textarea>
                </form-field>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
    <form [formGroup]="subtipoForm" class="container-fluid form-material">
      <div class="row">
        <div class="col-sm-12 col-12 col-md-12 col-lg-12 p-2">
          <div class="row">
            <div class="col-md-4">
              <form-field [control]="legalForm.get('identifier')">
                <ngx-select
                  [searchOnInit]="true"
                  [readonly]="!isIdent"
                  [data]="typesIdent"
                  [form]="legalForm"
                  label="Ident."
                  [searchable]="false"
                  bindLabel="identificador"
                  value="identificador"
                  control="identifier"></ngx-select>
              </form-field>
            </div>
            <div class="col-md-8">
              <form-field [control]="legalForm.get('type')">
                <ngx-select
                  [data]="typesClass"
                  searc
                  [form]="legalForm"
                  value="no_clasif_bien"
                  label="Subtipo - Ssubtipo - Sssubtipo"
                  bindLabel="nameGoodType"
                  control="type"
                  (change)="onTypesChange($event)"
                  [labelTemplate]="classNo"
                  [optionTemplate]="classSub"
                  [searchable]="false">
                </ngx-select>
                <ng-template #classNo let-item="item">
                  <div *ngIf="item.no_clasif_bien == 0">
                    {{ item.no_clasif_bien }} - {{ item.desc_sssubtipo }}
                  </div>
                  <div *ngIf="item.no_clasif_bien > 0">
                    {{ item.no_clasif_bien }} - {{ item.desc_ssubtipo }} -
                    {{ item.desc_ssubtipo }} - {{ item.desc_sssubtipo }}
                  </div>
                </ng-template>
                <ng-template #classSub let-item="item">
                  <div
                    *ngIf="item.no_clasif_bien == 0"
                    [title]="
                      item.no_clasif_bien +
                      '-' +
                      item.desc_subtipo +
                      '-' +
                      item.desc_ssubtipo +
                      '-' +
                      item.desc_sssubtipo
                    ">
                    {{ item.no_clasif_bien }} - {{ item.desc_sssubtipo }}
                  </div>
                  <div
                    *ngIf="item.no_clasif_bien > 0"
                    [title]="
                      item.no_clasif_bien +
                      '-' +
                      item.desc_subtipo +
                      '-' +
                      item.desc_ssubtipo +
                      '-' +
                      item.desc_sssubtipo
                    ">
                    {{ item.no_clasif_bien }} - {{ item.desc_subtipo }} -
                    {{ item.desc_ssubtipo }} - {{ item.desc_sssubtipo }}
                  </div>
                </ng-template>
              </form-field>
            </div>
          </div>
        </div>
      </div>
    </form>

    <div class="row pt-2">
      <div class="col-md-12 mt-4 mb-4">
        <hr class="row" />
        <h5 class="title">BIENES</h5>
        <br />
        <ng2-smart-table
          [attr.class]="'table-bordered table-responsive'"
          [settings]="settings1"
          [source]="goods"></ng2-smart-table>
      </div>
    </div>
    <div class="row pt-2">
      <div class="col-md-12 text-center mt-4 mb-4">
        <button
          class="btn btn-secondary btn-sm active m-3 p-1 pointer"
          type="button"
          (click)="addSelect()">
          <!-- Mover uno -->
          <i class="bx bx-chevron-down bx-md"></i>
        </button>
        <button
          class="btn btn-secondary btn-sm active m-3 p-1 pointer"
          type="button"
          (click)="addAll()">
          <!-- Mover todos -->
          <i class="bx bx-chevrons-down bx-md"></i>
        </button>
        <button
          class="btn btn-secondary btn-sm active m-3 p-1 pointer"
          type="button"
          (click)="removeAll()">
          <!-- Quitar todos -->
          <i class="bx bx-chevrons-up bx-md"></i>
        </button>
        <button
          class="btn btn-secondary btn-sm active m-3 p-1 pointer"
          type="button"
          (click)="removeSelect()">
          <!-- Quitar uno -->
          <i class="bx bx-chevron-up bx-md"></i>
        </button>
      </div>
    </div>
    <div class="row pt-2">
      <div class="col-md-12 mt-4 mb-4">
        <ng2-smart-table
          [attr.class]="'table-bordered table-responsive'"
          [settings]="settings2"
          [source]="goodsValid"
          (rowSelect)="rowSelected($event)"></ng2-smart-table>
      </div>
    </div>

    <div class="row pt-2">
      <div class="col-md-12">
        <hr class="row" />
      </div>
      <div class="col-md-8">
        <h5 class="title">DOCUMENTOS</h5>
        <div class="row">
          <div class="col-md-10">
            <ng2-smart-table
              [attr.class]="'table-bordered table-responsive'"
              [settings]="settings3"
              [source]="documents"></ng2-smart-table>
          </div>
          <div class="col-md-2">
            <p class="text-info h5">No&#46; bien</p>
            <p class="text-info h5">{{ idGoodSelected }}</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <button
          class="btn btn-primary btn-sm active m-3"
          [disabled]="isDocsEmpty()"
          (click)="btnApprove()">
          Aprobar
        </button>
        <button
          class="btn btn-danger btn-sm active m-3"
          (click)="btnDeleteDictation()"
          [disabled]="buttonDeleteDisabled">
          Borrar Dictamen
        </button>
        <button
          class="btn btn-info btn-sm active m-3"
          (click)="btnDocumentos()">
          Documentos
        </button>
        <button
          class="btn btn-warning btn-sm active m-3"
          (click)="btnVerify()"
          [disabled]="buttonDisabled">
          Parcializar
        </button>
        <button
          class="btn btn-warning btn-sm active m-3"
          (click)="btnDeleteListDocs()">
          Limpiar documentos
        </button>
      </div>
    </div>
  </div>
</app-card>

<app-card [header]="true" *ngIf="listadoDocumentos == true">
  <div class="ch-content" header>
    <h5 class="title">Fecha de Documentos Asociados al Tr&aacute;mite</h5>
  </div>

  <div body>
    <div class="row w-100">
      <div class="col-sm-12 col-12 col-md-12 p-2">
        <ng2-smart-table
          [attr.class]="'table-bordered'"
          [settings]="settings4"
          [source]="data4"></ng2-smart-table>
      </div>

      <div class="col-12 flex p-2">
        <div class="form-group text-right">
          <button
            class="btn btn-danger active btn-sm m-3"
            (click)="btnCloseDocs()">
            Cerrar Ventana
          </button>
          <button
            class="btn btn-primary active btn-sm m-3"
            (click)="btnSalir()">
            Cargar documentos
          </button>
        </div>
      </div>
    </div>
  </div>
</app-card>
