<app-card [header]="true" [footer]="true">
  <div class="ch-content" header>
    <h5 class="title">Notificaci&oacute;n de abandono por {{ title }}</h5>
  </div>
  <div body>
    <form [formGroup]="form" class="form-material">
      <div class="row">
        <div class="col-md-9 col-sm-12 col-xs-12">
          <ng-custom-select-loading
            [form]="form"
            [updateValues]="true"
            path="goodfinder/api/v1/good-query"
            label="No. Bien"
            formControlName="goodId"
            value="goodId"
            bindLabel="description"
            paramSearch="filter.description"
            prefixSearch="$ilike"
            secondParamSearch="filter.goodId"
            [labelTemplate]="GoodLabel"
            [optionTemplate]="GoodOption"
            (valueChange)="selectGood($event)">
          </ng-custom-select-loading>
          <ng-template #GoodLabel let-item="item"
            >{{ item.id }} - {{ item.description }}</ng-template
          >
          <ng-template #GoodOption let-item="item"
            >{{ item.id }} - {{ item.description }}</ng-template
          >
        </div>

        <div class="col-md-3 col-sm-12 col-xs-12">
          <form-field [control]="quantity" label="Cantidad">
            <input
              type="text"
              class="form-control"
              [readonly]="isdisable"
              formControlName="quantity" />
          </form-field>
        </div>
      </div>
      <div class="row mt-3" *ngIf="estatus_bien && estatus_bien.value">
        <form-field
          class="col-xs-12"
          [control]="form.get('estatus_bien')"
          label="Estatus Bien">
          <textarea
            rows="2"
            formControlName="estatus_bien"
            class="form-control"
            readonly></textarea>
        </form-field>
      </div>
      <div class="row mt-3" *ngIf="period">
        <div class="col-md-4 col-sm-12 col-xs-12">
          <div class="">
            <div class="mb-5">
              <form-field [control]="form.get('periods')" label="Periodo 1">
                <input
                  type="text"
                  class="form-control"
                  formControlName="periods" />
              </form-field>
            </div>
            <div class="mb-5">
              <form-field
                [control]="vf_ini1"
                label="Fecha Inicial"
                class="mt-1">
                <input
                  class="form-control"
                  formControlName="vf_ini1"
                  bsDatepicker
                  readonly />
              </form-field>
            </div>
            <div class="mb-5">
              <form-field [control]="vf_fin1" label="Fecha Final" class="mt-1">
                <input
                  class="form-control"
                  formControlName="vf_fin1"
                  bsDatepicker
                  readonly />
              </form-field>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-sm-12 col-xs-12">
          <div class="">
            <div class="mb-5">
              <form-field [control]="form.get('periods1')" label="Periodo 2">
                <input
                  type="text"
                  class="form-control"
                  formControlName="periods1" />
              </form-field>
            </div>
            <div class="mb-5">
              <form-field
                [control]="vf_ini2"
                label="Fecha Inicial"
                class="mt-1">
                <input
                  class="form-control"
                  formControlName="vf_ini2"
                  bsDatepicker
                  readonly />
              </form-field>
            </div>
            <div class="mb-5">
              <form-field [control]="vf_fin2" label="Fecha Final" class="mt-1">
                <input
                  class="form-control"
                  formControlName="vf_fin2"
                  bsDatepicker
                  readonly />
              </form-field>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-sm-12 col-xs-12" *ngIf="type === 'D'">
          <div class="">
            <div class="mb-5">
              <form-field [control]="form.get('periods2')" label="Periodo 3">
                <input
                  type="text"
                  class="form-control"
                  formControlName="periods2" />
              </form-field>
            </div>
            <div class="mb-5">
              <form-field
                [control]="vf_ini3"
                label="Fecha Inicial"
                class="mt-1">
                <input
                  class="form-control"
                  formControlName="vf_ini3"
                  bsDatepicker
                  readonly />
              </form-field>
            </div>
            <div class="mb-5">
              <form-field [control]="vf_fin3" label="Fecha Final" class="mt-1">
                <input
                  class="form-control"
                  formControlName="vf_fin3"
                  bsDatepicker
                  readonly />
              </form-field>
            </div>
          </div>
        </div>
      </div>
      <div class="form-inline justify-content-end btn-toolbar">
        <button
          type="button"
          class="btn btn-primary active btn-sm"
          [disabled]="!goodId.value"
          (click)="search()">
          Buscar
          <i class="bx bx-search-alt bx-sm float-icon"></i>
        </button>

        <button class="btn btn-danger btn-sm active" (click)="clean()">
          Limpiar <i class="fas fa-eraser"> </i>
        </button>
      </div>
      <div>
        <div class="row pt-4">
          <div class="d-flex">
            <div class="mt-3" *ngIf="totalItems > 0">
              <button
                (click)="accept()"
                class="btn btn-primary btn-sm active mr-3">
                Confirmar
              </button>
            </div>
            <div class="d-flex justify-content-end mt-3">
              <app-columns-select
                [leftList]="true"
                [(settings)]="settings"
                class="row justify-content-end"></app-columns-select>
            </div>
          </div>
        </div>
      </div>
      <div class="row pt-4" *ngIf="showTable">
        <div class="col-md-12">
          <div [class]="loading ? 'table-loading' : ''">
            <ng2-smart-table
              [attr.class]="'table-bordered table-responsive'"
              [settings]="settings"
              [source]="data"
              (create)="openModal(null)"
              (delete)="delete($event.data)"
              (edit)="openModal($event.data)"
              (userRowSelect)="onUserRowSelect($event)">
            </ng2-smart-table>
          </div>
        </div>
        <app-pagination
          [params]="params"
          [totalItems]="totalItems"></app-pagination>
      </div>
    </form>
  </div>
</app-card>
