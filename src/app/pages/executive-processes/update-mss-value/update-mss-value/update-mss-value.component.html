<app-card [header]="true">
  <div header>
    <div class="ch-content">
      <h5 class="title">
        PROCESO DE ACTUALIZACI&Oacute;N MASIVA DE VALOR AVALU&Oacute;
      </h5>
    </div>
  </div>
  <div body>
    <div class="row">
      <div class="col-md-6">
        <button
          type="button"
          class="btn btn-sm btn-success active m-1"
          (click)="fileExcel.click()">
          Importar Excel <i class="bi bi-file-earmark-excel-fill"></i>
        </button>
        <input
          type="file"
          (change)="ReadExcel($event)"
          name="fileExcel"
          #fileExcel
          class="d-none"
          accept=".xlsx, .xls, .csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
        <button class="btn btn-primary btn-sm active m-1">
          Procesar <i class="fa fa-check" aria-hidden="true"></i>
        </button>
        <button class="btn btn-danger btn-sm active mr-3" (click)="clean()">
          Limpiar <i class="fas fa-eraser"> </i>
        </button>
      </div>
      <div class="col-md-2">
        <label for="" class="form-group">Registros Leidos: 0</label>
      </div>
      <div class="col-md-2">
        <label for="" class="form-group">Registros Procesados: 0</label>
      </div>
    </div>
    <div class="ch-content">
      <h5 class="title">&nbsp;</h5>
      <div class="row justify-content-end mr-1">
        <div class="col-12">
          <app-columns-select
            [(settings)]="settings"
            class="row justify-content-end">
          </app-columns-select>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="table-responsive">
        <ng-scrollbar
          [track]="'all'"
          [ngStyle]="{ height: loading ? '0px' : '300px' }">
          <div [class]="loading ? 'table-loading' : ''">
            <ng2-smart-table
              [attr.class]="'table-bordered table-responsive'"
              [settings]="settings"
              [source]="source"></ng2-smart-table>
          </div>
        </ng-scrollbar>
      </div>
    </div>
    <app-pagination [params]="params" [totalItems]="totalItems">
    </app-pagination>
  </div>
</app-card>
