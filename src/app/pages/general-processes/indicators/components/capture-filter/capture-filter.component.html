<div>
  <form [formGroup]="formCapture" class="form-material">
    <div class="row pt-3">
      <form-field
        [control]="formCapture.get('fecStart')"
        label="Rango de fechas"
        class="col-md-3">
        <input
          type="text"
          class="form-control"
          bsDatepicker
          formControlName="fecStart"
          [maxDate]="maxDate" />
      </form-field>

      <form-field
        [control]="formCapture.get('fecEnd')"
        label="A"
        class="col-md-3">
        <input
          type="text"
          class="form-control"
          bsDatepicker
          formControlName="fecEnd"
          [min]="formCapture.get('fecStart').value"
          [minDate]="formCapture.get('fecStart').value"
          [ngModel]="
            formCapture.get('fecEnd').value < formCapture.get('fecStart').value
              ? formCapture.get('fecStart').value
              : formCapture.get('fecEnd').value
          "
          bsDatepicker />
      </form-field>

      <!-- <form-field *ngIf="
          !isReceptionAndDelivery && !isReceptionStrategies && !isConsolidated
        " [control]="formCapture.get('fecEnd')" label="Fecha Ingreso" class="col-md-3">
        <input type="text" class="form-control" bsDatepicker formControlName="fecEnd" [maxDate]="maxDate" />
      </form-field> -->

      <form-field
        [control]="formCapture.get('typeSteering')"
        class="col-md-3"
        label="Tipo Volante"
        *ngIf="!isReceptionStrategies && !isConsolidated">
        <select class="form-control" formControlName="typeSteering">
          <option *ngFor="let type of flyerTypes" [value]="type">
            {{ type }}
          </option>
        </select>
      </form-field>
    </div>

    <!-- <form-field *ngIf="
        (isReceptionAndDelivery || isReceptionStrategies) && !isConsolidated
      " [control]="form.get('tipoEvento')" class="col-md-3" label="Tipo Evento">
      <select class="form-control" formControlName="tipoEvento">
        <option *ngFor="let event of eventTypes" [value]="event">
          {{ event }}
        </option>
      </select>
    </form-field> -->
    <!-- 
    <div class="row mt-4">
      <div class="col-md-12">
        <form-field [control]="formCapture.get('coordinacion_regional')">
          <ngx-select [form]="formCapture" [searchOnInit]="true" control="coordinacion_regional" label="Coor. Regional"
            [data]="delegations" (fetchItems)="getDelegations($event)" className="scroll-line"
            bindLabel="description"></ngx-select>
        </form-field>
      </div>
    </div> -->

    <div class="row pt-3" *ngIf="!isReceptionAndDelivery">
      <form-field [control]="formCapture.get('user')" class="col-md-6">
        <ngx-select
          label="Usuario"
          [form]="formCapture"
          [readonly]="dictNumber ? true : false"
          [data]="users$"
          (fetchItems)="getUsers($event)"
          bindLabel="userAndName"
          control="user"
          [searchOnInit]="true"
          [showTooltip]="true"
          termMaxLength="30"
          [labelTemplate]="userLabel"
          [optionTemplate]="userOption">
        </ngx-select>
        <ng-template #userLabel let-item="item">
          {{ item.id + ' - ' + item.name }}
        </ng-template>
        <ng-template #userOption let-item="item">
          <div [title]="item.id + '-' + item.name">
            {{ item.id + ' - ' + item.name }}
          </div>
        </ng-template>
      </form-field>

      <!-- <form-field [control]="formCapture.get('cveJobExternal')" class="col-md-6"
        *ngIf="!isReceptionStrategies && !isConsolidated">
        <ngx-select [form]="formCapture" [searchOnInit]="true" control="cveJobExternal" label="Clave Oficio Externo"
          [data]="affairName" (fetchItems)="getSubjects($event)" className="scroll-line" bindLabel="description">
        </ngx-select>
      </form-field> -->

      <form-field [control]="formCapture.get('cvCoors')">
        <ngx-select
          [form]="formCapture"
          [searchOnInit]="true"
          control="cvCoors"
          label="Coor. Regional"
          [data]="delegations"
          (fetchItems)="getDelegations($event)"
          className="scroll-line"
          bindLabel="description"
          [multiple]="true"></ngx-select>
      </form-field>
    </div>

    <div class="row pt-3" *ngIf="!isReceptionStrategies && !isConsolidated">
      <form-field [control]="formCapture.get('noTransfere')" class="col-md-4">
        <ngx-select
          [searchOnInit]="true"
          (fetchItems)="getTransference($event)"
          [data]="transference"
          [form]="formCapture"
          bindLabel="nameTransferent"
          label="Transferente"
          control="noTransfere">
        </ngx-select>
      </form-field>

      <form-field [control]="formCapture.get('noStation')" class="col-md-4">
        <ngx-select
          [searchOnInit]="true"
          (fetchItems)="
            getStation(
              formCapture.get('noTransfere').value,
              formCapture.get('noStation').value
            )
          "
          [data]="station"
          [form]="formCapture"
          bindLabel="stationName"
          label="Emisora"
          control="noStation">
        </ngx-select>
      </form-field>
      <form-field [control]="formCapture.get('noAuthority')" class="col-md-4">
        <ngx-select
          [searchOnInit]="true"
          (fetchItems)="
            getAuthority(
              formCapture.get('noTransfere').value,
              formCapture.get('noStation').value,
              formCapture.get('noAuthority').value
            )
          "
          [data]="authority"
          [form]="formCapture"
          bindLabel="authorityName"
          label="Autoridad"
          control="noAuthority">
        </ngx-select>
      </form-field>
    </div>

    <div footer>
      <div class="d-flex justify-content-center">
        <div class="m-3">
          <button
            type="button"
            class="btn btn-primary active btn-sm"
            (click)="find(this.capture)">
            Consulta <i class="bx bx-search-alt bx-sm float-icon"></i>
          </button>
        </div>
        <div class="m-3">
          <button
            type="button"
            class="btn btn-primary active btn-sm"
            (click)="Generar()">
            Reporte <i class="fas fa-print bx-sm float-icon"></i>
          </button>
        </div>

        <div class="m-3">
          <button
            type="button"
            class="btn btn-danger active btn-sm"
            (click)="cleanForm()">
            Limpiar <i class="fas fa-eraser bx-sm float-icon"></i>
          </button>
        </div>
      </div>
    </div>

    <div footer>
      <div class="d-flex justify-content-center">
        <div class="m-3">
          <button
            class="btn btn-success btn-sm ml-2 active"
            [disabled]="formCapture.invalid"
            type="button"
            (click)="exportExcel()">
            Exportar a Excel
            <i class="bx bx-download float-icon"></i>
          </button>
          <input
            type="file"
            name="file1"
            #file1
            class="d-none"
            formControlName="file1"
            accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
            (change)="onFileChangeDelivery($event)" />
        </div>
      </div>
    </div>
  </form>
</div>
