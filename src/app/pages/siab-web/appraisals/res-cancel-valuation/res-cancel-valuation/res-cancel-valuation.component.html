<app-card [header]="true">
  <div header>
    <div class="ch-content">
      <h5 class="title">Respuesta &#47; cancelaci&oacute;n valuaci&oacute;n</h5>
    </div>
  </div>
  <div body>
    <div class="d-flex justify-content-end">
      <div class="ml-auto" style="margin-top: -20px">
        <p class="font-weight-bold" style="border-bottom: 1px solid black">
          {{ dateNow | date : 'dd/MM/yyyy - HH:mm:ss' }}
        </p>
      </div>
    </div>
    <div class="d-flex justify-content-center mb-3" style="margin-top: -20px">
      <h3>
        <span id="lblTipoAccOficio">{{ lblTipoAccOficio }}</span>
        <span id="lbltipOficio">{{ lbltipOficio }}</span>
        <span> PARA </span>
        <span id="lblDireccion">{{ lblDireccion }}</span>
        <small>
          <span id="lblCvlOfocio">{{ lblCvlOfocio }}</span>
        </small>
      </h3>
    </div>

    <br />
    <!--  -->
    <div>
      <form class="form-material" [formGroup]="form">
        <div class="row">
          <div class="col-md-5">
            <form-field [control]="form.get('event')" label="Evento">
              <input
                type="number"
                class="form-control"
                formControlName="event" />
            </form-field>
          </div>
          <div class="col-md-7">
            <form-field [control]="form.get('office')">
              <ngx-select
                [searchOnInit]="true"
                (fetchItems)="getOffices($event)"
                [data]="offices"
                [form]="form"
                bindLabel="cveJob"
                label="Folios de Oficios de Avalúos"
                control="office">
              </ngx-select>
            </form-field>
          </div>
        </div>
        <!--  -->
        <div class="row mt-3" *ngIf="pnlControles">
          <div class="col-md-3"></div>
          <div class="col-md-4" style="margin-left: -20px">
            <form-radio label="Oficio de Respuesta">
              <input type="radio" value="2" formControlName="radio" />
            </form-radio>
          </div>
          <div class="col-md-4 ml-auto">
            <form-radio label="Oficio de Cancelación">
              <input type="radio" value="3" formControlName="radio" />
            </form-radio>
          </div>
          <div class="col-md-2"></div>
        </div>
        <!--  -->
        <div class="row mt-3">
          <div class="col-md-4">
            <form-field [control]="form.get('fol')" label="Folio">
              <input type="text" class="form-control" formControlName="fol" />
            </form-field>
          </div>
          <div class="col-md-4">
            <form-field [control]="form.get('key')" label="Clave">
              <input type="text" class="form-control" formControlName="key" />
            </form-field>
          </div>
          <div class="col-md-4">
            <form-field [control]="form.get('cityCi')">
              <ngx-select
                (fetchItems)="queryCyties($event)"
                [searchOnInit]="true"
                label="Ciudad"
                [data]="fullCyties"
                [form]="form"
                bindLabel="nameCity"
                control="cityCi">
              </ngx-select>
            </form-field>
          </div>
        </div>
        <!--  -->
        <div class="row mt-3">
          <div class="col-md-6">
            <form-field [control]="form.get('dateRec')" label="Fecha Recepción">
              <input
                type="text"
                class="form-control"
                formControlName="dateRec"
                bsDatepicker />
            </form-field>
          </div>
          <div class="col-md-6">
            <form-field
              [control]="form.get('dateEla')"
              label="Fecha Elaboración">
              <input
                type="text"
                class="form-control"
                formControlName="dateEla"
                bsDatepicker />
            </form-field>
          </div>
        </div>
        <!--  -->
        <div class="row mt-3">
          <div class="col-md-6">
            <ng-custom-select-loading
              [form]="form"
              [path]="pathDest"
              [bodyPost]="bodyRemi"
              [updateValues]="true"
              typeInput="post"
              label="Remitente"
              formControlName="remi"
              paramSearch="filter.usuario"
              prefixSearch="$eq"
              value="usuario"
              bindLabel="nombre"
              [labelTemplate]="userLabel"
              [optionTemplate]="userOption">
            </ng-custom-select-loading>
            <ng-template #userLabel let-item="item"
              >{{ item.usuario }} - {{ item.nombre }}</ng-template
            >
            <ng-template #userOption let-item="item"
              >{{ item.usuario }} - {{ item.nombre }}</ng-template
            >

            <!-- <form-field [control]="form.get('remi')">
              <ngx-select
                (fetchItems)="queryAllUsers($event)"
                [searchOnInit]="true"
                label="Remitente"
                [data]="fullUsers"
                [form]="form"
                bindLabel="usuario"
                control="remi">
                <ng-template #userLabel let-item="item"
                  >{{ item.usuario }} - {{ item.nombre }}</ng-template
                >
                <ng-template #userOption let-item="item"
                  >{{ item.usuario }} - {{ item.nombre }}</ng-template
                >
              </ngx-select>
            </form-field> -->
          </div>
          <div class="col-md-6">
            <ng-custom-select-loading
              [form]="form"
              [path]="pathDest"
              [bodyPost]="bodyDest"
              [updateValues]="true"
              typeInput="post"
              label="Destinatario"
              formControlName="dest"
              paramSearch="filter.usuario"
              prefixSearch="$eq"
              value="usuario"
              bindLabel="nombre"
              [labelTemplate]="userLabel"
              [optionTemplate]="userOption">
            </ng-custom-select-loading>
            <ng-template #userLabel let-item="item"
              >{{ item.usuario }} - {{ item.nombre }}</ng-template
            >
            <ng-template #userOption let-item="item"
              >{{ item.usuario }} - {{ item.nombre }}</ng-template
            >

            <!-- <form-field [control]="form.get('dest')">
              <ngx-select
                (fetchItems)="queryAllUsersTwo($event)"
                [searchOnInit]="true"
                label="Destinatario"
                [data]="fullUsersTwo"
                [form]="form"
                bindLabel="usuario"
                control="dest"
                [labelTemplate]="userLabel"
                [optionTemplate]="userOption">
                <ng-template #userLabel let-item="item"
                  >{{ item.usuario }} - {{ item.nombre }}</ng-template
                >
                <ng-template #userOption let-item="item"
                  >{{ item.usuario }} - {{ item.nombre }}</ng-template
                >
              </ngx-select>
            </form-field> -->
          </div>
        </div>
        <!--  -->
        <div class="row mt-5">
          <div class="col-md-12">
            <form-field [control]="form.get('ref')" label="Referencia">
              <textarea class="form-control" formControlName="ref"></textarea>
            </form-field>
          </div>
        </div>
        <!--  -->
        <div class="row mt-2">
          <div class="col-md-12">
            <form-field [control]="form.get('aten')" label="Atención">
              <textarea class="form-control" formControlName="aten"></textarea>
            </form-field>
          </div>
        </div>
        <!--  -->
        <div class="row mt-2">
          <div class="col-md-12">
            <form-field [control]="form.get('espe')" label="Especificaciones">
              <textarea class="form-control" formControlName="espe"></textarea>
            </form-field>
          </div>
        </div>
        <!--  -->
      </form>
    </div>
    <br />
    <!--  -->
    <div class="d-flex justify-content-end">
      <div class="ml-auto">
        <button class="btn btn-danger btn-sm active" (click)="reset()">
          Limpiar <i class="fas fa-eraser"> </i>
        </button>
      </div>
    </div>
    <!--  -->
    <app-valued-table [body]="body1" [settings1]="settings"></app-valued-table>
    <!--  -->
    <app-cancel-table
      [body]="body2"
      [officeType]="officeType"
      [showModalCambioRev]="showModalCambioRev"></app-cancel-table>
    <!--  -->
    <div>
      <div>
        <form class="form-material" [formGroup]="formTwo">
          <!--  -->
          <div class="row" *ngIf="pnlControles2">
            <div class="col-md-6">
              <form-field
                [control]="formTwo.get('allGood')"
                label="Total de Bienes">
                <textarea
                  class="form-control"
                  formControlName="allGood"></textarea>
              </form-field>
            </div>
            <div class="col-md-6">
              <form-field
                [control]="formTwo.get('selectedGood')"
                label="Bienes Seleccionados">
                <textarea
                  class="form-control"
                  formControlName="selectedGood"></textarea>
              </form-field>
            </div>
          </div>
          <div clas="row">
            <div class="d-flex">
              <div class="ml-auto" *ngIf="btnMotCan">
                <button
                  class="btn btn-primary btn-sm active"
                  (click)="showModal()">
                  Motivos de Cambio a REV
                </button>
              </div>
            </div>
          </div>
          <!--  -->
          <div class="row mb-3">
            <div class="col-md-6">
              <div
                [class]="loadingExcel ? 'disabled' : ''"
                (click)="exportExcel()">
                <app-excel-report
                  [elementToExport]="elementsToExport"
                  [externalClick]="flagDownload"
                  [nameExcel]="nameExcel"
                  text="Exportar a Excel"></app-excel-report>
              </div>
            </div>
            <div class="col-md-6">
              <button type="button" class="btn btn-sm btn-success active">
                Importar Excel <i class="bi bi-file-earmark-excel-fill"></i>
              </button>
            </div>
          </div>
          <!--  -->
          <!-- <div class="row mt-5">
                    <div class="col-md-12">
                      <form-field [control]="formTwo.get('ref')" label="Referencia">
                        <textarea class="form-control" formControlName="ref"></textarea>
                      </form-field>
                    </div>
                  </div> -->
          <!--  -->
          <!-- <div class="row mt-2">
                    <div class="col-md-12">
                      <form-field [control]="formTwo.get('aten')" label="Atención">
                        <textarea class="form-control" formControlName="aten"></textarea>
                      </form-field>
                    </div>
                  </div> -->
          <!--  -->
          <!-- <div class="row mt-2">
                    <div class="col-md-12">
                      <form-field [control]="formTwo.get('espe')" label="Especificaciones">
                        <textarea class="form-control" formControlName="espe"></textarea>
                      </form-field>
                    </div>
                  </div> -->
          <!--  -->
          <!--  -->
          <div>
            <app-card [header]="true">
              <div header>
                <div class="ch-content">
                  <h5 class="title">Con Copia Para:</h5>
                </div>
              </div>
              <div body>
                <form class="form-material" [formGroup]="formThree">
                  <!--  -->
                  <div class="row" style="margin-left: -20px">
                    <form-radio label="Por Delegación">
                      <input
                        type="radio"
                        value="cat"
                        [(ngModel)]="radioValueThree"
                        (change)="onRadioChangeThree()"
                        [value]="true"
                        formControlName="radioThree" />
                    </form-radio>
                  </div>
                  <!--  -->
                  <div class="row pt-5">
                    <div class="col-md-4" *ngIf="visibleUserName">
                      <ng-custom-select-loading
                        [form]="formThree"
                        [path]="pathDest"
                        [bodyPost]="bodyDest"
                        [updateValues]="true"
                        typeInput="post"
                        label="Destinatario"
                        formControlName="user"
                        paramSearch="filter.usuario"
                        prefixSearch="$eq"
                        value="usuario"
                        bindLabel="nombre"
                        [labelTemplate]="userLabel"
                        [optionTemplate]="userOption">
                      </ng-custom-select-loading>
                      <ng-template #userLabel let-item="item"
                        >{{ item.usuario }} - {{ item.nombre }}</ng-template
                      >
                      <ng-template #userOption let-item="item"
                        >{{ item.usuario }} - {{ item.nombre }}</ng-template
                      >

                      <!-- <form-field [control]="formThree.get('user')">
                        <ngx-select
                          (fetchItems)="getUsersDesList($event)"
                          [searchOnInit]="true"
                          [data]="usersList"
                          [form]="formThree"
                          value="usuario"
                          label="Usuario y Nombre"
                          bindLabel="nombre"
                          [(ngModel)]="rowCopySelect"
                          control="user"
                          (change)="getUsersDesList()"
                          [labelTemplate]="userLabel"
                          [optionTemplate]="userOption">
                        </ngx-select>
                        <ng-template #userLabel let-item="item"
                          >{{ item.usuario }} - {{ item.nombre }}</ng-template
                        >
                        <ng-template #userOption let-item="item"
                          >{{ item.usuario }} - {{ item.nombre }}</ng-template
                        >
                      </form-field> -->
                    </div>
                    <div class="col-md-4" *ngIf="visibleDelegation">
                      <form-field [control]="formThree.get('del')">
                        <ngx-select
                          (fetchItems)="queryDelegations($event)"
                          [searchOnInit]="true"
                          label="Delegación"
                          [data]="fullDelegations"
                          [form]="formThree"
                          bindLabel="description"
                          [(ngModel)]="rowCopySelect"
                          control="del"
                          (change)="getDepartments()">
                        </ngx-select>
                      </form-field>
                    </div>
                    <div class="col-md-4" *ngIf="visibleDepartments">
                      <form-field [control]="formThree.get('depar')">
                        <ngx-select
                          (fetchItems)="getDepartments($event)"
                          [searchOnInit]="true"
                          [data]="fullDepartments"
                          [form]="formThree"
                          label="Departamentos"
                          bindLabel="descripcion"
                          control="depar">
                        </ngx-select>
                      </form-field>
                    </div>
                  </div>
                  <div class="d-flex">
                    <div class="ml-auto">
                      <div class="justify-content-center">
                        <button
                          type="button"
                          tooltip="Agregar"
                          containerClass="tooltip-style"
                          class="btn btn-info btn-sm active"
                          (click)="getAddUser()">
                          Agregar
                          <i class="bx bx-plus bx-sm float-icon"></i>
                        </button>
                      </div>
                    </div>
                    <div class="ml-3">
                      <div class="justify-content-center">
                        <button
                          type="button"
                          class="btn btn-red btn-sm active"
                          (click)="removeUserCopy()">
                          Eliminar
                          <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                  <!--  -->
                  <div>
                    <form-field [control]="formThree.get('copy')" label="Copia">
                      <select class="form-control" formControlName="copy">
                        <option><small> Seleccione </small></option>
                        <option *ngFor="let item of arrayCopy">
                          {{ item }}
                        </option>
                      </select>
                    </form-field>
                  </div>
                  <!--  -->
                  <!--  -->
                </form>
              </div>
            </app-card>
          </div>
          <div class="d-flex justify-content-center">
            <div class="m-3" *ngIf="btnModificar">
              <button type="button" class="btn btn-primary btn-sm active">
                Modificar Oficio
              </button>
            </div>
            <div class="m-3" *ngIf="btnVerOficio">
              <button
                type="button"
                class="btn btn-primary btn-sm active"
                (click)="viewOffice()">
                Visualizar Oficio
              </button>
            </div>
            <div class="m-3" *ngIf="btnGuardar">
              <button
                type="button"
                class="btn btn-primary btn-sm active"
                [disabled]="form.invalid"
                (click)="save()">
                Guardar Oficio
              </button>
            </div>
            <div class="m-3" *ngIf="btnEnviar">
              <button type="button" class="btn btn-primary btn-sm active">
                Enviar Oficio
              </button>
            </div>
          </div>
          <!--  -->

          <!--  -->
          <!-- Modal #1 -->
          <!-- <div style="border: 1px solid black; padding: 10px; border-radius: 20px">
            <p>Este es el modal #1</p>
            <div>
              <form class="form-material" [formGroup]="formDialogOne">
                <div class="row mt-5">
                  <div class="col-md-12">
                    <form-field [control]="formDialogOne.get('noti')" label="Notificaciones">
                      <textarea class="form-control" formControlName="noti"></textarea>
                    </form-field>
                  </div>
                </div>
                
              </form>
              <div class="d-flex justify-content-center">
                <div class="m-3">
                  <button type="button" class="btn btn-primary btn-sm active">
                    Cerrar
                    <i aria-hidden="true" class="fa fa-save"></i>
                  </button>
                </div>
                <div class="m-3">
                  <button type="button" class="btn btn-primary btn-sm active">
                    Continuar
                    <i aria-hidden="true" class="fa fa-save"></i>
                  </button>
                </div>
              </div>
            </div>
          </div> -->
          <!--  -->
        </form>
      </div>
    </div>
    <!--  -->
  </div>
</app-card>
