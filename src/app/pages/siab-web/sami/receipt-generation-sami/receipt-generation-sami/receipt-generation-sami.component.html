<app-card [header]="true">
  <div header>
    <div class="ch-content">
      <h5 class="title">Generacion de Recibos</h5>
    </div>
  </div>
  <div body>
    <form [formGroup]="programmingForm" class="form-material">
      <div class="row margin-input">
        <div class="col-md-8">
          <form-field
            label="Ingresa la Programaci&oacute;n"
            [control]="programmingForm.get('programmingId')">
            <input
              type="text"
              class="form-control"
              formControlName="programmingId" />
          </form-field>
        </div>
        <div class="col-md-2">
          <button
            type="button"
            class="btn btn-primary active btn-sm"
            (click)="searchPrograming()">
            Buscar
            <i class="bx bx-search-alt bx-sm float-icon"></i>
          </button>
        </div>
      </div>
      <div class="row margin-input">
        <div class="col-md-12">
          <form-field [control]="programmingForm.get('managementId')">
            <!-- <input type="text" class="form-control" formControlName="managementId" /> -->
            <ngx-select
              (fetchItems)="programmingGoodReceipt($event)"
              [data]="goodsList"
              [form]="programmingForm"
              value="id_bien"
              bindLabel="descripcion_bien"
              label="No. Gesti&oacute;n"
              control="managementId"
              [labelTemplate]="goodLabel"
              [optionTemplate]="goodOption"
              (change)="searchManagement($event)">
            </ngx-select>
            <ng-template #goodLabel let-item="item">
              {{ item.id_bien }} - {{ item.descripcion_bien }}
            </ng-template>
            <ng-template #goodOption let-item="item">
              <div [title]="item.id_bien + '-' + item.descripcion_bien">
                {{ item.id_bien }} - {{ item.descripcion_bien }}
              </div>
            </ng-template>
          </form-field>
        </div>
        <!-- <div class="col-md-2">
                    <button type="button" class="btn btn-primary active btn-sm">
                        Buscar
                        <i class="bx bx-search-alt bx-sm float-icon"></i>
                    </button>
                </div> -->
      </div>
    </form>

    <div class="row pt-2">
      <div class="col-md-4">
        <label class="label" for=""
          >No. Gesti&oacute;n: <span> {{ goodID }} </span></label
        >
      </div>
      <div class="col-md-4">
        <label class="label" for=""
          >Clave &Uacute;nica: <span> {{ uniqueKey }} </span></label
        >
      </div>
      <div class="col-md-4">
        <label class="label" for=""
          >Expediente: <span> {{ noFile }} </span></label
        >
      </div>
      <div class="col-md-4 pt-2">
        <label class="label" for=""
          >Destino Trasferente:
          <span> {{ destinoTransferenteLetra }} </span></label
        >
      </div>
      <div class="col-md-4 pt-2">
        <label class="label" for=""
          >Cantidad Trasferente: <span> {{ quantity }} </span></label
        >
      </div>
      <div class="col-md-4 pt-2">
        <label class="label" for=""
          >Unidad Medida Trasferente: <span> {{ unitMeasure }} </span></label
        >
      </div>
      <div class="col-md-4 pt-2">
        <label class="label" for=""
          >Estado F&iacute;sico Trasferente:
          <span> {{ physicalStateLetter }} </span></label
        >
      </div>
      <div class="col-md-4 pt-2">
        <label class="label" for=""
          >Estado Conservaci&oacute;n Trasferente:
          <span> {{ letterConservationStatus }} </span></label
        >
      </div>
      <div class="col-md-4 pt-2">
        <label class="label" for=""
          >Destino Ligie: <span> {{ destinationLetter }} </span></label
        >
      </div>
      <div class="col-md-12 pt-2">
        <label class="label" for=""
          >Descripci&oacute;n Trasferente:
          <span> {{ descriptionGood }} </span></label
        >
      </div>
    </div>
    <form [formGroup]="indepForm" class="form-material">
      <div class="row margin-input">
        <div class="col-md-12">
          <form-field
            [control]="indepForm.get('descripcion_bien_sae')"
            label="Descripci&oacute;n INDEP">
            <textarea
              formControlName="descripcion_bien_sae"
              class="form-control"></textarea>
          </form-field>
        </div>
      </div>
      <div class="row margin-input">
        <div class="col-md-4">
          <form-field
            label="Cantidad INDEP"
            [control]="indepForm.get('cantidad_sae')">
            <input
              type="number"
              class="form-control"
              formControlName="cantidad_sae" />
          </form-field>
        </div>
        <div class="col-md-4">
          <form-field [control]="indepForm.get('unidad_medida_sae')">
            <ngx-select
              (fetchItems)="unitsQuery($event)"
              [data]="unitsList"
              [form]="indepForm"
              value="uom_code"
              bindLabel="unit_of_measure_tl"
              label="Unidad Medida INDEP"
              control="unidad_medida_sae">
            </ngx-select>
            <!-- <input type="text" class="form-control" formControlName="unidad_medida_sae" /> -->
          </form-field>
        </div>
        <div class="col-md-4">
          <form-field [control]="indepForm.get('estado_fisico_sae')">
            <ngx-select
              (fetchItems)="getGenericE($event)"
              [data]="physicalStateList"
              [form]="indepForm"
              value="keyId"
              bindLabel="description"
              label="Estado F&iacute;sico INDEP"
              control="estado_fisico_sae">
            </ngx-select>
            <!-- <input type="text" class="form-control" formControlName="estado_fisico_sae" /> -->
          </form-field>
        </div>
        <div class="col-md-4 pt-2">
          <form-field [control]="indepForm.get('estado_conservacion_sae')">
            <ngx-select
              (fetchItems)="getGenericEC($event)"
              [data]="stateConservationList"
              [form]="indepForm"
              value="keyId"
              bindLabel="description"
              label="Estado Conservaci&oacute;n INDEP"
              control="estado_conservacion_sae">
            </ngx-select>
            <!-- <input type="text" class="form-control" formControlName="estado_conservacion_sae" /> -->
          </form-field>
        </div>
        <div class="col-md-4 pt-2">
          <form-field [control]="indepForm.get('destino_sae')">
            <ngx-select
              (fetchItems)="getGenericD($event)"
              [data]="detinationList"
              [form]="indepForm"
              value="keyId"
              bindLabel="description"
              label="Destino INDEP"
              control="destino_sae">
            </ngx-select>
            <!-- <input type="text" class="form-control" formControlName="destino_sae" /> -->
          </form-field>
        </div>
      </div>
    </form>

    <tr>
      <td colspan="5" align="center">
        <button
          class="btn btn-primary active btn-sm m-2"
          (click)="assignReceiptOne(0)"
          [disabled]="!indepForm.valid">
          Asignar Recibo
        </button>
        <button
          class="btn btn-primary active btn-sm m-2"
          (click)="assignReceiptOne(1)"
          [disabled]="!indepForm.valid">
          Resguardo
        </button>
        <button
          class="btn btn-primary active btn-sm m-2"
          (click)="assignReceiptOne(2)"
          [disabled]="!indepForm.valid">
          Almac√©n
        </button>
        <button
          class="btn btn-primary active btn-sm m-2"
          (click)="reprogrammingOne()"
          [disabled]="!indepForm.valid">
          Reprogramaci&oacute;n
        </button>
        <button
          class="btn btn-primary active btn-sm m-2"
          (click)="cancellationOne()"
          [disabled]="!indepForm.valid">
          Cancelaci&oacute;n
        </button>
      </td>
    </tr>
    <div class="row margin-input">
      <form [formGroup]="indepForm" class="form-material">
        <div class="col-md-8 pt-2" *ngIf="cancellationView">
          <form-field [control]="indepForm.get('cancellation')">
            <ngx-select
              (fetchItems)="getGenericC($event)"
              [data]="cancellationList"
              [form]="indepForm"
              value="keyId"
              bindLabel="description"
              label="Seleccione el motivo de la Cancelaci&oacute;n"
              control="cancellation">
            </ngx-select>
          </form-field>
        </div>
        <div class="col-md-4 pt-2" *ngIf="cancellationView">
          <button
            class="btn btn-primary btn-sm active mr-3"
            (click)="acceptCancellation()">
            Aceptar
          </button>
        </div>
        <div class="col-md-8 pt-2" *ngIf="reprogramingView">
          <form-field [control]="indepForm.get('reprogramming')">
            <ngx-select
              (fetchItems)="getGenericR($event)"
              [data]="reprogramingList"
              [form]="indepForm"
              value="keyId"
              bindLabel="description"
              label="Seleccione el motivo de la Reprogramaci&oacute;n"
              control="reprogramming">
            </ngx-select>
          </form-field>
        </div>
        <div class="col-md-4 pt-2" *ngIf="reprogramingView">
          <button
            class="btn btn-primary btn-sm active mr-3"
            (click)="acceptReprogramming()">
            Aceptar
          </button>
        </div>
      </form>
    </div>
    <app-receipt-table-goods></app-receipt-table-goods>
  </div>
</app-card>
