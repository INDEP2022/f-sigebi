<app-modal>
  <div header>
    <h5 class="modal-title">
      {{ newOrEdit ? 'Editar' : 'Nuevo' }} {{ title }}
    </h5>
  </div>
  <div body>
    <form
      action=""
      class="form-material"
      [formGroup]="form"
      *ngIf="this.type == 1 || this.type == 2 || this.type == 3">
      <div class="row">
        <div class="col-12">
          <div class="row">
            <div class="col-4">
              <form-field [control]="form.get('labelId')">
                <ngx-select
                  [searchOnInit]="true"
                  [form]="form"
                  control="labelId"
                  [data]="labels"
                  value="id"
                  bindLabel="idAndDesc"
                  label="Etiqueta"
                  (fetchItems)="listLabel($event)">
                </ngx-select>
              </form-field>
            </div>
            <div class="col-md-3">
              <form-field [control]="form.get('unit')">
                <ngx-select
                  [searchOnInit]="true"
                  [form]="form"
                  control="unit"
                  [data]="units"
                  value="unit"
                  bindLabel="unit"
                  label="Unidad"
                  (fetchItems)="listUnidades($event)">
                </ngx-select>
                <!-- <input type="text" maxlength="30" class="form-control" formControlName="unit" /> -->
              </form-field>
            </div>
            <div class="col-md-3">
              <form-field [control]="form.get('valid')" label="Válida">
                <ng-select
                  formControlName="valid"
                  [searchable]="false"
                  class="form-control"
                  [clearable]="false">
                  <ng-option value="1">Sí</ng-option>
                  <ng-option value="0">No</ng-option>
                </ng-select>
              </form-field>
            </div>
            <div class="col-2">
              <form-field [control]="form.get('ruleId')" label="Id Regla">
                <input
                  readonly
                  type="number"
                  maxlength="40"
                  class="form-control"
                  formControlName="ruleId" />
              </form-field>
            </div>
          </div>
        </div>

        <div class="col-4 mt-2">
          <form-field [control]="form.get('status')">
            <ngx-select
              [searchOnInit]="true"
              [form]="form"
              control="status"
              [data]="status"
              value="status"
              bindLabel="status"
              label="Estatus"
              (change)="insertDescStatus($event)"
              (fetchItems)="listStatus($event)">
            </ngx-select>
            <!-- <input type="text" maxlength="3" class="form-control" formControlName="status" /> -->
          </form-field>
        </div>

        <div class="col-md-8 mt-2">
          <form-field [control]="form.get('desStatus')" label="Desc. Estatus.">
            <textarea
              rows="2"
              cols="2"
              readonly
              type="text"
              maxlength="100"
              class="form-control"
              formControlName="desStatus"></textarea>
          </form-field>
        </div>
        <div class="col-4 mt-2">
          <form-field [control]="form.get('transferentId')">
            <ngx-select
              [searchOnInit]="true"
              [form]="form"
              control="transferentId"
              [data]="transfers"
              value="id"
              bindLabel="id"
              label="No. Trans."
              (change)="insertDescTrans($event)"
              (fetchItems)="listTransfer($event)">
            </ngx-select>
          </form-field>
        </div>
        <div class="col-md-8 mt-2">
          <form-field [control]="form.get('keyCode')" label="Desc. Trans.">
            <textarea
              rows="2"
              cols="2"
              readonly
              type="text"
              maxlength="100"
              class="form-control"
              formControlName="keyCode"></textarea>
            <!-- <input
              readonly
              type="text"
              maxlength="100"
              class="form-control"
              formControlName="keyCode" /> -->
          </form-field>
        </div>
        <div class="col-4 mt-2">
          <form-field [control]="form.get('clasifId')">
            <ngx-select
              [searchOnInit]="true"
              [form]="form"
              control="clasifId"
              [data]="clasifs"
              value="numClasifGoods"
              bindLabel="numClasifGoods"
              label="No. Clasif."
              (change)="insertDescClasif($event)"
              (fetchItems)="listClasif($event)">
            </ngx-select>
            <!-- <input type="number" maxlength="40" class="form-control" formControlName="clasifId" /> -->
          </form-field>
        </div>
        <div class="col-8 mt-2">
          <form-field [control]="form.get('desClasif')" label="Desc. Clasif.">
            <textarea
              rows="2"
              cols="2"
              readonly
              type="text"
              maxlength="100"
              class="form-control"
              formControlName="desClasif"></textarea>
            <!-- <input
              readonly
              type="text"
              maxlength="100"
              class="form-control"
              formControlName="desClasif" /> -->
          </form-field>
        </div>

        <div class="col-md-4 mt-2" *ngIf="this.type == 3">
          <form-field [control]="form.get('amount')" label="Cantidad">
            <input
              currencyMask
              type="text"
              class="form-control"
              formControlName="amount" />
          </form-field>
        </div>
      </div>
      <div class="row">
        <!-- <div class="col-md-6">
          <form-field [control]="form.get('transferentId')" label="No. Trans.">
            <input
              type="number"
              maxlength="40"
              class="form-control"
              formControlName="transferentId" />
          </form-field>
        </div> -->
        <!-- <div class="col-md-6">
          <form-field [control]="form.get('keyCode')" label="Des. Trans.">
            <input
              type="text"
              maxlength="100"
              class="form-control"
              formControlName="keyCode" />
          </form-field>
        </div> -->
        <!-- <div class="col-md-6">
          <form-field [control]="form.get('clasifId')" label="No. Clasif.">
            <input
              type="number"
              maxlength="40"
              class="form-control"
              formControlName="clasifId" />
          </form-field>
        </div>
        <div class="col-md-6">
          <form-field [control]="form.get('desClasif')" label="Des. Clasif.">
            <input
              type="text"
              maxlength="100"
              class="form-control"
              formControlName="desClasif" />
          </form-field>
        </div>
        
        <div class="col-md-6" *ngIf="this.type == 3">
          <form-field [control]="form.get('amount')" label="Cantidad">
            <input
              type="number"
              class="form-control"
              formControlName="amount" />
          </form-field>
        </div> -->
      </div>
    </form>

    <form
      action=""
      class="form-material"
      [formGroup]="form"
      *ngIf="this.type == 4">
      <div class="row">
        <!-- <div class="col-md-6">
          <form-field [control]="form.get('otkey')" label="Clave">
            <input type="number" maxlength="15" class="form-control" formControlName="otkey" />
          </form-field>
        </div> -->
        <div class="col-md-9">
          <!-- <form-field [control]="form.get('value')" label="Usuario">
            <input type="text" class="form-control" formControlName="value" />
          </form-field> -->
          <ng-custom-select-loading
            [form]="form"
            formControlName="value"
            label="Usuario"
            value="id"
            bindLabel="name"
            loadingText="Cargando usuarios..."
            typeToSearchText="Escriba el nombre del usuario"
            path="users/api/v1/seg-users"
            [labelTemplate]="usuarioLabel"
            [readonly]="newOrEdit"
            [optionTemplate]="usuarioOption">
          </ng-custom-select-loading>
        </div>
        <ng-template #usuarioLabel let-item="item">
          {{ item.id }} - {{ item.name }}
        </ng-template>
        <ng-template #usuarioOption let-item="item">
          <div [title]="item.id + '-' + item.name">
            {{ item.id }} - {{ item.name }}
          </div>
        </ng-template>

        <!-- <div class="col-md-6">
          <form-field [control]="form.get('name')" label="Nombre">
            <input type="text" class="form-control" formControlName="name" />
          </form-field>
        </div> -->
        <div class="col-md-3">
          <form-field [control]="form.get('valid')" label="Abreviatura">
            <ng-select
              style="margin-top: 5px"
              formControlName="valid"
              [searchable]="false"
              class="form-control"
              [clearable]="false">
              <ng-option value="S">Sí</ng-option>
              <ng-option value="N">No</ng-option>
            </ng-select>
          </form-field>
        </div>
      </div>
    </form>
  </div>
  <div footer>
    <div class="d-flex justify-content-center">
      <div class="m-3">
        <confirm-button
          [text]="this.textBtn"
          [icon]="
            this.newOrEdit
              ? 'fas fa-save bx-sm float-icon'
              : 'fas fa-save bx-sm float-icon'
          "
          [type]="'button'"
          [loading]="false"
          [btnSmall]="true"
          [disabled]="form.invalid"
          (confirm)="confirm()">
        </confirm-button>
      </div>
      <div class="m-3">
        <button
          type="button"
          class="btn btn-danger active btn-sm"
          (click)="close()">
          Cancelar
        </button>
      </div>
    </div>
  </div>
</app-modal>
