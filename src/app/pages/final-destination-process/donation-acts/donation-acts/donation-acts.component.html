<app-card [header]="true">
  <div class="ch-content" header>
    <h5 class="title">Actas de Donaci&oacute;n</h5>
    <!-- <div class="col-md-6 buttons">
      <div>
        <button class="btn btn-primary btn-sm active m-1" (click)="desbFrom()">
          Nueva Acta
          <i class="bx bx-search-alt bx-sm float-icon"></i>
        </button>
      </div>
    </div> -->
  </div>

  <div body>
    <accordion [isAnimated]="true">
      <accordion-group [isOpen]="true">
        <div accordion-heading class="d-flex justify-content-between">
          <h5>EXPEDIENTE</h5>
        </div>
        <div class="float-right pl-3">
          <button
            (click)="searchExpediente()"
            class="btn btn-primary btn-sm active m-1"
            tooltip="Lista de Expedientes"
            containerClass="tooltip-style">
            <i class="bx bx-list-plus bx-sm float-icon"></i>
          </button>
        </div>
        <app-card [header]="false" [footer]="false">
          <div body>
            <!-- FORMULARIO EXPEDIENTE -->
            <form [formGroup]="form" class="form-material">
              <div class="row">
                <div class="col-4 mt-2">
                  <form-field
                    [control]="form.get('no_expediente')"
                    label="No. Expediente">
                    <input
                      readonly
                      type="number"
                      class="form-control"
                      formControlName="no_expediente"
                      [(ngModel)]="noExpe" />
                  </form-field>
                </div>
                <div class="col-8 mt-2">
                  <form-field
                    [control]="form.get('av_previa')"
                    label="Averiguaci&oacute;n Previa">
                    <input
                      readonly
                      type="text"
                      class="form-control"
                      formControlName="av_previa" />
                  </form-field>
                </div>
                <div class="col-4 mt-2">
                  <form-field
                    [control]="form.get('ca_penal')"
                    label="Causa Penal">
                    <input
                      readonly
                      type="text"
                      class="form-control"
                      formControlName="ca_penal" />
                  </form-field>
                </div>
                <div class="col-4 mt-2">
                  <form-field
                    [control]="form.get('no_transferente')"
                    label="No. Exp. Transferente">
                    <input
                      readonly
                      type="text"
                      class="form-control"
                      formControlName="no_transferente" />
                  </form-field>
                </div>
                <div class="col-2 mt-2">
                  <form-field
                    [control]="form.get('ti_expediente')"
                    label="Ti. Expediente">
                    <input
                      readonly
                      type="text"
                      class="form-control"
                      formControlName="ti_expediente" />
                  </form-field>
                </div>
                <div class="col-2 mt-2">
                  <button
                    (click)="resetForm()"
                    class="btn btn-danger btn-block btn-sm active mt-1">
                    Limpiar <i class="fas fa-eraser"> </i>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </app-card>
      </accordion-group>
    </accordion>
    <accordion [isAnimated]="true">
      <accordion-group [isOpen]="true">
        <div accordion-heading class="d-flex justify-content-between">
          <h5>ACTAS Y BIENES RELACIONADOS</h5>
        </div>
        <div class="float-right pl-3">
          <button
            [disabled]="!dataExpediente"
            (click)="searchActa()"
            class="btn btn-primary btn-sm active m-1"
            tooltip="Lista de Actas"
            containerClass="tooltip-style">
            <i class="bx bx-list-plus bx-sm float-icon"></i>
          </button>
        </div>
        <app-card [header]="false" [footer]="false">
          <div body>
            <div class="row mb-3 mt-2 ml-1 mr-1">
              <div class="col-4">
                <h6>ACTA</h6>
              </div>
              <div class="col-md-8 text-end">
                <button
                  [disabled]="!dataExpediente || !actaCerrada"
                  (click)="save()"
                  type="button"
                  class="btn btn-primary active btn-sm mr-3">
                  Guardar
                  <i aria-hidden="true" class="fa fa-save"></i>
                </button>
                <!-- <button [disabled]="!dataExpediente" (click)="agregarActa()" type="button" class="btn btn-info active btn-sm mr-3">
                  Nueva Acta
                  <i class="bx bx-plus bx-sm float-icon"></i>
                </button> -->
                <button
                  [ngClass]="{ loading: loadingBtn }"
                  [disabled]="!dataExpediente || !actaCerrada"
                  class="btn btn-primary btn-sm active mr-3"
                  (click)="cerrarActa()">
                  Cerrar Acta
                </button>
                <button
                  (click)="cleanActa()"
                  type="button"
                  class="btn btn-danger active btn-sm">
                  Limpiar
                  <i class="fa fa-eraser" aria-hidden="true"></i>
                </button>
              </div>
            </div>
            <app-card [header]="false" [footer]="false">
              <div body>
                <form [formGroup]="claveActaForm" class="form-material">
                  <div class="row">
                    <div class="col-md-2 mt-2">
                      <div>
                        <form-field
                          [control]="claveActaForm.get('acta')"
                          label="Acta">
                          <ng-select
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            formControlName="acta"
                            class="form-control pt-1">
                            <ng-option value="DON">DON</ng-option>
                          </ng-select>
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-2 mt-2">
                      <div>
                        <form-field
                          [control]="claveActaForm.get('type')"
                          label="Estado">
                          <ng-select
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            formControlName="type"
                            class="form-control pt-1">
                            <ng-option value="A">A</ng-option>
                            <ng-option value="D">D</ng-option>
                            <ng-option value="RT">RT</ng-option>
                            <ng-option value="NA">NA</ng-option>
                          </ng-select>
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-4 mt-2">
                      <div>
                        <form-field [control]="claveActaForm.get('claveTrans')">
                          <ngx-select
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            [form]="claveActaForm"
                            [data]="trans"
                            (fetchItems)="consultREG_TRANSFERENTES($event)"
                            bindLabel="transfer"
                            value="password"
                            control="claveTrans"
                            label="Cve. Transferente"
                            [searchOnInit]="true"
                            [showTooltip]="true"
                            termMaxLength="30">
                          </ngx-select>
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-2 mt-2">
                      <div>
                        <form-field
                          [control]="claveActaForm.get('cveReceived')">
                          <ngx-select
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            [form]="claveActaForm"
                            [data]="dele"
                            (fetchItems)="consulREG_DEL_ADMIN($event)"
                            bindLabel="cveReceived"
                            value="delegation"
                            control="cveReceived"
                            label="Admin"
                            [searchOnInit]="false"
                            [showTooltip]="true"
                            termMaxLength="30">
                          </ngx-select>
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-2 mt-2">
                      <div>
                        <form-field [control]="claveActaForm.get('administra')">
                          <ngx-select
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            [form]="claveActaForm"
                            [data]="arrayDele"
                            (fetchItems)="consulREG_DEL_DESTR($event)"
                            bindLabel="cveAdmin"
                            value="delegation"
                            control="administra"
                            label="Don"
                            [searchOnInit]="false"
                            [showTooltip]="true"
                            termMaxLength="30">
                          </ngx-select>
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-2 mt-2">
                      <div>
                        <form-field
                          [control]="claveActaForm.get('consec')"
                          label="Folio">
                          <input
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            [max-length]="4"
                            pattern="^[0-9]+"
                            type="number"
                            class="form-control pt-1"
                            formControlName="consec" />
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-2 mt-2">
                      <div>
                        <form-field
                          [control]="claveActaForm.get('anio')"
                          label="Año">
                          <ng-select
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            class="form-control pt-1"
                            formControlName="anio"
                            [items]="years"
                            [ngModel]="currentYear"></ng-select>
                        </form-field>
                      </div>
                    </div>
                    <div class="col-md-2 mt-2">
                      <div>
                        <form-field
                          [control]="claveActaForm.get('mes')"
                          label="Mes">
                          <ng-select
                            [readonly]="
                              !dataExpediente || !valClave || !actaCerrada
                            "
                            class="form-control pt-1"
                            formControlName="mes"
                            [items]="months"></ng-select>
                        </form-field>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </app-card>
            <app-card [header]="false" [footer]="false">
              <div body>
                <form [formGroup]="actaRecepttionForm" class="form-material">
                  <div class="row">
                    <div class="col-6 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('cveActa')"
                        label="Acta:">
                        <input
                          readonly
                          type="text"
                          class="form-control"
                          formControlName="cveActa" />
                      </form-field>
                    </div>
                    <div class="col-3 mt-2">
                      <form-field
                        [control]="
                          actaRecepttionForm.get('datePhysicalReception')
                        "
                        label="Fecha Recepción Física:">
                        <input
                          [ngClass]="{
                            'not-press bg-gray': !actaCerrada || !dataExpediente
                          }"
                          #datepickerElement
                          type="text"
                          class="form-control"
                          formControlName="datePhysicalReception"
                          bsDatepicker
                          [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }" />
                      </form-field>
                    </div>
                    <div class="col-3 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('elaboradate')"
                        label="Fecha de Elaboración">
                        <input
                          [ngClass]="{
                            'not-press bg-gray': !actaCerrada || !dataExpediente
                          }"
                          #datepickerElement
                          type="text"
                          class="form-control pt-1"
                          formControlName="elaboradate"
                          bsDatepicker
                          [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }" />
                      </form-field>
                    </div>
                    <div class="col-3 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('statusActa')"
                        label="Estatus Acta:">
                        <ng-select
                          [readonly]="!actaCerrada || !dataExpediente"
                          formControlName="statusActa"
                          class="form-control pt-1">
                          <ng-option value="ABIERTA">ABIERTA</ng-option>
                          <ng-option value="SOLICITADO">SOLICITADO</ng-option>
                          <ng-option value="AUTORIZADO">AUTORIZADO</ng-option>
                          <ng-option value="CERRADA">CERRADA</ng-option>
                        </ng-select>
                      </form-field>
                    </div>
                    <div class="col-3 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('folio')"
                        label="Folio de Escaneo:">
                        <input
                          [readonly]="!actaCerrada || !dataExpediente"
                          type="text"
                          class="form-control"
                          formControlName="folio" />
                      </form-field>
                    </div>
                    <div class="col-6 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('testigoTwo')"
                        label="Nombre Entrega:">
                        <input
                          [readonly]="!actaCerrada || !dataExpediente"
                          type="text"
                          class="form-control"
                          formControlName="testigoTwo" />
                      </form-field>
                    </div>
                    <div class="col-6 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('testigoTree')"
                        label="Nombre Recibe:">
                        <input
                          [readonly]="!actaCerrada || !dataExpediente"
                          type="text"
                          class="form-control"
                          formControlName="testigoTree" />
                      </form-field>
                    </div>
                    <div class="col-6 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('respConv')"
                        label="Auditor:">
                        <input
                          [readonly]="!actaCerrada || !dataExpediente"
                          type="text"
                          class="form-control"
                          formControlName="respConv" />
                      </form-field>
                    </div>
                    <div class="col-6 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('testigoOIC')"
                        label="Testigo de Contraloria:">
                        <input
                          [readonly]="!actaCerrada || !dataExpediente"
                          type="text"
                          class="form-control"
                          formControlName="testigoOIC" />
                      </form-field>
                    </div>
                    <div class="col-12 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('direccion')"
                        label="Dirección:">
                        <textarea
                          [readonly]="!actaCerrada || !dataExpediente"
                          type="text"
                          rows="3"
                          cols="3"
                          class="form-control"
                          formControlName="direccion"></textarea>
                      </form-field>
                    </div>
                    <div class="col-12 mt-2">
                      <form-field
                        [control]="actaRecepttionForm.get('observaciones')"
                        label="Observaciones:">
                        <textarea
                          [readonly]="!actaCerrada || !dataExpediente"
                          type="text"
                          rows="3"
                          cols="3"
                          class="form-control"
                          formControlName="observaciones"></textarea>
                      </form-field>
                    </div>
                  </div>
                </form>
              </div>
            </app-card>
          </div>
        </app-card>
        <app-card [header]="false" [footer]="false">
          <div body>
            <div>
              <div class="col-md-12 justify-content-center">
                <h6>BIENES RELACIONADOS CON EL EXPEDIENTE</h6>
                <div class="row">
                  <form-loader *ngIf="loading"></form-loader>
                  <div class="col-md-12">
                    <ng-scrollbar
                      [track]="'all'"
                      [ngStyle]="{ height: loading ? '0px' : '400px' }">
                      <ng2-smart-table
                        [attr.class]="'table-bordered table-responsive'"
                        [settings]="settings1"
                        [source]="datas"
                        (userRowSelect)="rowSelectedOne($event)">
                      </ng2-smart-table>
                    </ng-scrollbar>
                  </div>

                  <app-pagination
                    [params]="paramsOne"
                    [totalItems]="totalItems"></app-pagination>
                  <form [formGroup]="form2" class="form-material">
                    <div class="row">
                      <div class="col-6 mt-4">
                        <form-field
                          [control]="form2.get('estatusPrueba')"
                          label="Estatus Bien">
                          <input
                            [(ngModel)]="statusGood_"
                            type="text"
                            class="form-control"
                            formControlName="estatusPrueba"
                            readonly />
                        </form-field>
                      </div>
                      <div
                        class="col-6 text-center justify-content-center mt-4">
                        <p class="">
                          <span class="text-success mr-5"
                            ><i class="fa fa-square"></i>Disponibles</span
                          >
                          <span class="text-dark"
                            ><i class="fa fa-square"></i>No disponibles</span
                          >
                        </p>
                      </div>
                    </div>
                  </form>
                </div>
              </div>

              <div class="row pt-2">
                <div class="col-md-12 text-center mt-4 mb-4">
                  <button
                    tooltip="Agregar Bien al Acta"
                    containerClass="tooltip-style"
                    class="btn btn-secondary btn-sm active m-3 p-1 pointer"
                    type="button"
                    (click)="addSelect()">
                    <!-- Mover uno -->
                    <i class="bx bx-chevron-down bx-md"></i>
                  </button>
                  <button
                    tooltip="Quitar Bien del Acta"
                    containerClass="tooltip-style"
                    class="btn btn-secondary btn-sm active m-3 p-1 pointer"
                    type="button"
                    (click)="removeSelect()">
                    <!-- Quitar uno -->
                    <i class="bx bx-chevron-up bx-md"></i>
                  </button>
                </div>
              </div>
              <!-- <div class="col-md-12 text-center mt-4 mb-4">
                    <button
                      type="button"
                      tooltip="Agregar"
                      containerClass="tooltip-style"
                      class="btn btn-info btn-sm active ml-2 mr-2"
                      (click)="createTableTwo()">
                      Agregar <i class="bx bx-plus bx-sm float-icon"></i>
                    </button>
                    <button
                      class="btn btn-red btn-sm active m-3"
                      (click)="deleteTableTwo()">
                      Eliminar <i class="fa fa-trash" aria-hidden="true"></i>
                    </button>
                  </div> -->
              <div class="col-md-12">
                <h6>BIENES RELACIONADOS CON EL ACTA</h6>
                <div class="row">
                  <form-loader *ngIf="loading2"></form-loader>
                  <div class="col-md-12">
                    <ng-scrollbar
                      [track]="'all'"
                      [ngStyle]="{ height: loading2 ? '0px' : '400px' }">
                      <ng2-smart-table
                        class="table-responsive"
                        [attr.class]="'table-bordered table-responsive'"
                        [settings]="settings2"
                        (userRowSelect)="rowSelectedTwo($event)"
                        [source]="data2">
                      </ng2-smart-table>
                    </ng-scrollbar>
                  </div>
                  <app-pagination
                    [params]="params2"
                    [totalItems]="totalItems2"></app-pagination>
                </div>
              </div>
            </div>
          </div>
        </app-card>
      </accordion-group>
    </accordion>
    <!-- <div class="row mb-5">
      <div class="d-flex justify-content-center">
        <div>
          <button type="button" class="btn btn-primary btn-sm active mr-3">
            Guardar
            <i aria-hidden="true" class="fa fa-save"></i>
          </button>
          <button class="btn btn-primary btn-sm active" (click)="closeExp()">
            Cerrar acta
          </button>
        </div>
      </div>
    </div> -->
  </div>
</app-card>
